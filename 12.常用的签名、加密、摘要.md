## 摘要算法

常用签名特征：

- `MD5`：128位（16字节）的哈希值，通常表示为32个十六进制字符的字符串。例：`65a8e27d8879283831b664bd8b7f0ad4`

- `SHA`：
  `SHA-1` 160位 20字节 40个十六进制字符数  
  `2ef7bde608ce5404e97d5f042f95f89f1c232871`
  `SHA-224` 224位 28字节 56个十六进制字符数  `7509e5bda0c790bd2237f30198406d6dee3fd9dbf8a159742bbf7b35dfa607e6b1`
  `SHA-256` 256位 32字节 64个十六进制字符数  `dff9f635e95f328830bb4c1df673cdd4654f2299dcb9a40fad5f98ccddacbebc`
  `SHA-384` 384位 48字节 96个十六进制字符数  `59e1748777448c69de6b800d7a33bbfb9ff1b463e44354c3553bcdb9c666fa90125a2fecd9e3673435d90f2dfad27bba1`
  `SHA-512` 512位 64字节 128个十六进制字符数  `309ecc489c12d6eb4cc40f50c902f2b4d0ed77ee511a7c7a9bcd3ca86d4cd86f989dd35bc5ff499670da34255b45b0cfd830e81f605dcf7dc5542e93ae9cd76f`

- `HMAC`：密钥的安全性是`HMAC`的核心。`HMAC` 是一种基于哈希函数的消息认证码，通常与`SHA-256`、`SHA-1`等哈希算法结合使用。
  `HMAC-SHA-1`  160位 20字节 40个十六进制字符数
  `HMAC-SHA-256`  256位 32字节 64个十六进制字符数

  `HMAC-SHA-512`  512位 64字节 128个十六进制字符数
  `HMAC-MD5`  128位 16字节 32个十六进制字符数

### 1. MD5

简介：全称` MD5` 消息摘要算法，又称哈希算法、散列算法，由美国密码学家`罗纳德·李维斯特`设计，于 1992 年作为 RFC 1321 被公布，用以取代 `MD4` 算法。摘要算法是单向加密的，也就是说明文通过摘要算法加密之后，是不能解密的。摘要算法的第二个特点密文是固定长度的，它通过一个函数，把任意长度的数据转换为一个长度固定的数据串（通常用`16进制`的字符串表示）。之所以叫摘要算法，它的算法就是提取明文重要的特征。所以，两个不同的明文，使用了摘要算法之后，有可能他们的密文是一样的，不过这个概率非常的低。

#### 1.1 JavaScript 实现

安装对应的模块

```javascript
// 在依赖项中添加包： --save
npm install crypto-js  --save
```

**使用案例**

```JavaScript
// 引用 crypto-js 加密模块
var CryptoJS = require('crypto-js')

function MD5Test() {
    var text = "I love python!"
    return CryptoJS.MD5(text).toString()
}

console.log(MD5Test()) 
```

#### 1.2 Python 实现

```python
import hashlib

def md5_test2():
    md5 = hashlib.md5()
    md5.update('python'.encode('utf-8'))
    print(md5.hexdigest())

if __name__ == '__main__':
    md5_test2() 
```

**总结：**`MD5`哈希视为字符串，而是将其视为十六进制数， `MD5`哈希长度为128位，通常由`32`个十六进制数字表示。



### 2. SHA

简介：全称安全哈希算法，由美国国家安全局`（NSA）`所设计，主要适用于数字签名标准里面定义的数字签名算法，`SHA` 通常指 `SHA` 家族的五个算法，分别是` SHA-1、SHA-224、SHA-256、SHA-384、SHA-512`，`SHA` 是比 `MD5` 更安全一点的摘要算法，`MD5` 的密文是 32 位，而 `SHA-1` 是 40 位，版本越强，密文越长，代价是速度越慢。

#### 2.1  JavaScript 实现

```JavaScript
// 引用 crypto-js 加密模块
var CryptoJS = require('crypto-js')

function SHA1Encrypt() {
    var text = "I love python!"
    return CryptoJS.SHA1(text).toString();
}

console.log(SHA1Encrypt()) 
```

#### 2.2 Python 实现

```python
import hashlib

def sha1_test2():
    sha1 = hashlib.sha1()
    sha1.update('I love python!'.encode('utf-8'))
    print(sha1.hexdigest())

if __name__ == '__main__':
    sha1_test2() 
```

#### 2.3 `sha`系列特征

```
sha1:23c02b203bd2e2ca19da911f1d270a06d86719fb
sha224:1ffeffcbe2707dc5d1c10df619203c1a3b620c70394b3c4c106d92e6
sha256:c3a845a318cd654749ea4db6f4d5f9cb5c6e5b0cade46d9dc04af46d32049c7c
sha512:af47f324b77a4885748bfc3f0d9b5a846c0153c589852bb3f185ab6e7a600547b818ab994776e8d24584457f9aac84246b0de971584cebbdd96aa1aee6630f9f
```

总结：根据长度进行定位、主要还是要去JavaScript里面下断点调试分析



### 3. `HMAC`

简介：全称散列消息认证码、密钥相关的哈希运算消息认证码，于 1996 年提出，1997 年作为 RFC 2104 被公布，`HMAC` 加密算法是一种安全的基于加密 `Hash` 函数和共享密钥的消息认证协议，它要求通信双方共享密钥 key、约定算法、对报文进行 `Hash` 运算，形成固定长度的认证码。通信双方通过认证码的校验来确定报文的合法性。

参考资料：

- 百科：https://baike.baidu.com/item/hmac/7307543?fr=aladdin

#### 3.1 JavaScript 实现

```JavaScript
// 引用 crypto-js 加密模块
var CryptoJS = require('crypto-js')

function HMACEncrypt() {
    var text = "I love python!"
    var key = "secret"   // 密钥文件
    return CryptoJS.HmacMD5(text, key).toString();
    // return CryptoJS.HmacSHA1(text, key).toString();
    // return CryptoJS.HmacSHA256(text, key).toString();
}
console.log(HMACEncrypt())
```

#### 3.2 Python 实现

```python
import hmac

def hmac_test1():
    message = 'I love python!'.encode()
    key = b'secret'
    md5 = hmac.new(key, message, digestmod='MD5')
    print(md5.hexdigest())

def hmac_test2():
    key = 'secret'.encode('utf8')
    sha1 = hmac.new(key, digestmod='sha1')
    sha1.update('I love '.encode('utf8'))
    sha1.update('Python!'.encode('utf8'))
    print(sha1.hexdigest())

if __name__ == '__main__':
    hmac_test1()  # 9c503a1f852edcc3526ea56976c38edf
    hmac_test2()  # 2d8449a4292d4bbeed99ce9ea570880d6e19b61a
```



### 4. 实战案例

#### 1 案例 `md5`加密逆向

#####  **逆向目标**

+ 主页：https://www.mytokencap.com/

+ 逆向字段：`code: '9c503a1f852edcc3526ea56976c38edf'`

##### **逆向分析**

1. 先进行抓包，可以看到有一个签名信息 `code`

   这里推荐下`xhr`断点调试进行分析，这里直接发送请求了而且code已经生成，我们走到该函数入口；
   ![image-20241223150011990](.\image\image-20241223150011990.png)
   ![image-20241223150224542](.\image\image-20241223150224542.png)
   上面看到入口就已经是包含code参数了，继续跟栈；
   跟踪到一个请求拦截器中，如下，你会发现e = o()(r + "9527" + r.substr(0, 6));是我们想要的n.data.code的生成位置。断点并进入函数o()()，o()是返回一个函数所以这里操作的函数为o()()。
   ![image-20241223150626322](.\image\image-20241223150626322.png)
   ![image-20241223151332764](.\image\image-20241223151332764.png)
   这里是就是加密地点了，可以webpack扣代码允许或者控制台输出一下就知道这个加密是啥了。

##### **python代码模拟**

```python
import hashlib,time
// o()(n + "9527" + n.substr(0, 6))

def md5_test2():
    n = str(int(time.time())*1000)
    value = n + "9527" + n[0:6]
    md5 = hashlib.md5()
    md5.update(value.encode('utf-8'))
    print(md5.hexdigest())

if __name__ == '__main__':
    md5_test2() 
```



#### 2 案例`sha256`系列

**逆向目标**

+ 主页：http://www.hh1024.com/

+ 接口：https://ucp.hrdjyun.com:60359/api/dy

+ 逆向参数：`sign: "0d2864b1420c42f12de6efeff30bcb4b458157d8177675b8910fa632524604cb"`

#####  python代码实现

```python
import urllib3,requests,time,json
urllib3.disable_warnings()
import hashlib

months = input("请输入查询月份：")
days = input("请输入查询日期,2天以内：")
times = str(int(time.time()) * 1000)
params = {"no":"dy0002","data":{"days":1,"rankType":5,"liveDay":f"2023-{months.zfill(2)}-{days.zfill(2)}"}}
print(params)
dd = json.dumps(params)
def get_sign():
    data = f'param={dd}&timestamp={times}&tenant=1&salt=kbn%&)@<?FGkfs8sdf4Vg1*+;`kf5ndl$'  # 要进行加密的数据
    data_sha = hashlib.sha256(data.encode('utf-8')).hexdigest()
    return data_sha

def get_data():
    headers = {
        "Content-Type": "application/json;charset=UTF-8",
        "Host": "ucp.hrdjyun.com:60359",
        "Origin": "http://www.hh1024.com",
        "Pragma": "no-cache",
        "sec-ch-ua": "\"Google Chrome\";v=\"107\", \"Chromium\";v=\"107\", \"Not=A?Brand\";v=\"24\"",
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": "\"Windows\"",
        "Sec-Fetch-Dest": "empty",
        "Sec-Fetch-Mode": "cors",
        "Sec-Fetch-Site": "cross-site",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36"
    }
    session = requests.session()
    s = get_sign()
    t = "这里面是登陆后的token值"
    datas = {"param":dd,"sign":s,"tenant":"1","timestamp":times,"token":t}
    url = 'https://ucp.hrdjyun.com:60359/api/dy'
    res = session.post(url,headers=headers,data=json.dumps(datas))
    if res.json().get('status') == 0:
        data = res.json().get('data')['rankList']
        for d in data:
            items = {}
            items['抖音名'] = d.get('anchorName')
            items['带货销量'] ='%.2f' % (d.get('salesVolume') / 10000) + '万'
            print(items)

if __name__ == '__main__':
    reads = """
        本接口只开放抖音带货销量日榜
        可以根据日期查询
                                --- 夏洛
        """
    print(reads)
    get_data()
```



#### 3 案例`Hmac`系列

##### 1. **逆向目标**

+ 主页：https://www.qcc.com/
+ 接口:https://www.qcc.com/api/datalist/touzilist?keyNo=5dffb644394922f9073544a08f38be9f&pageIndex=2
+ 逆向字段：`code: '9c503a1f852edcc3526ea56976c38edf'`

##### 2. **逆向分析**

- 定位加密的位置
- 关键字定位

```JavaScript
// 前端代码赋值请求头的代码
aa.setRequestHeader('sign', '值')
aa.headers['sign'] = '值'
aa.headers: {}
// 可以搜索这些关键字定位
```

- 调试定位

```
调试定位在异步的js代码里面比较麻烦,我们可以先定位到异步执行代码之前下好断点,先快速的过一般,在脑海里有大楷的印象,看看数据大致的生成位置,前面先粗调试,确定好大致位置之后再精调
```

![image-20241223172200976](.\image\image-20241223172200976.png)

- 可以看出我们的请求头在这里生成的
- i的生成是`(0,a.default)(t, e.data)`
- l的生成是`l = (0,r.default)(t, e.data, (0,s.default)());`
- `(0,r.default)`是js的逗号操作符我们可以直接`r.default()`来进行调用
- 键值对都是通过网址来进行加密的,可以直接进函数进行对比

##### 3. 逆向结果

- JavaScript代码

```JavaScript
var cryptojs = require('crypto-js')

var dd = {
    "n": 20,
    "codes": {
        "0": "W",
        "1": "l",
        "2": "k",
        "3": "B",
        "4": "Q",
        "5": "g",
        "6": "f",
        "7": "i",
        "8": "i",
        "9": "r",
        "10": "v",
        "11": "6",
        "12": "A",
        "13": "K",
        "14": "N",
        "15": "k",
        "16": "4",
        "17": "L",
        "18": "1",
        "19": "8"
    }
}
var r = function () {
    for (var e = (arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "/").toLowerCase(), t = e + e, n = "", i = 0; i < t.length; ++i) {
        var a = t[i].charCodeAt() % dd.n;
        n += dd.codes[a]
    }
    return n
};

var r1 = function (e, t) {
    return cryptojs.HmacSHA512(e, t).toString();
};


var s = function () {
    var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}
        , t = (arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "/").toLowerCase()
        , n = JSON.stringify(e).toLowerCase();
    return (0,
        r1)(t + n, (0,
        r)(t)).toLowerCase().substr(8, 20)
};


var s1 = function () {
    var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}
        , t = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : ""
        , n = (arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "/").toLowerCase()
        , i = JSON.stringify(e).toLowerCase();
    return r1(n + "pathString" + i + t,
        r(n))
};

function xxx(t) {
    data = undefined
    var i = (0,
        s)(t, data)

    l = s1(t, data, '210314b3d12062c234e868105494964d')
    return {
        'key': i,
        'value': l
    }

}

t = "/api/datalist/holdcolist?isnewagg=true&keyno=6b242b475738f45a4dd180564d029aa9&pageindex=7"
xxx(t)
```

- python代码

```python
import requests
import execjs


class Qcc():
    def __init__(self):
        self.headers = {
            'cookie': 'qcc_did=4ec3aa37-7e00-4ba3-8981-4561cd125939; UM_distinctid=18a6ad8612d1ad-0dbe600f638f27-26031f51-1fa400-18a6ad8612e17f9; CNZZDATA1254842228=338542179-1694009680-%7C1694700549; QCCSESSID=c79eec2efbd4d79857830f58a7',
            "referer": "https://www.qcc.com/firm/6b242b475738f45a4dd180564d029aa9.html",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36",
        }
        self.url = "https://www.qcc.com/api/datalist/holdcolist?isNewAgg=true&keyNo=6b242b475738f45a4dd180564d029aa9&pageIndex={}"

    def get_data(self):
        for i in range(1, 3):
            js = execjs.compile(open('demo.js', encoding='utf-8').read())
            pa = '/api/datalist/holdcolist?isnewagg=true&keyno=6b242b475738f45a4dd180564d029aa9&pageindex={}'.format(i)
            he = js.call('xxx', pa)
            self.headers[he['key']] = he['value']
            response = requests.get(self.url.format(i), headers=self.headers)
            print(response.text)


if __name__ == '__main__':
    qcc = Qcc()
    qcc.get_data()

```



## 对称加密

对称加密（加密解密密钥相同）：DES、3DES、AES、RC4

**简介**

对称式加密就是加密和解密使用同一个密钥。信息接收双方都需事先知道密匙和加解密算法且其密匙是相同的，之后便是对数据进行加解密了。对称加密算法用来对敏感数据等信息进行加密。

![image-20241223173807875](.\image\image-20241223173807875.png)

### 一. 常见算法归纳

**DES：**56位密钥，由于密钥太短，被逐渐被弃用。

**AES：**有128位、192位、256位密钥，现在比较流行。密钥长、可以增加破解的难度和成本。



#### 1. 工作模式归纳

##### 1. ECB模式 

- 全称Electronic Codebook模式，译为电子密码本模式，每个数据块独立进行加/解密

- ECB是最简单的工作模式，原理就是将明文分组，对每一组分别单独加密，加密后的每组密文之间没有联系,在将每一组加密的结果进行拼接

![image-20241223175546796](.\image\image-20241223175546796.png)

- 解密流程如下

![image-20241223175553035](.\image\image-20241223175553035.png)



##### 2. CBC模式 

- 全称Cipher Block Chaining模式，译为密文分组链接模式

- 这种模式的核心思想是每一个明文分组在被加密之前要与前一个的密文分组进行异或运算，即每一组的加密结果会参与下一个分组的加密，因此第一个分组加密需要有一个初始化向量（IV）参与。
- 最后将每个密文分组按顺序合并起来就得到加密结果
- CBC模式是分组加密中使用最多的模式。

![image-20241223175657314](.\image\image-20241223175657314.png)

- 解密方式

![image-20241223175702672](.\image\image-20241223175702672.png)

##### 3. **CFB模式** 

- 全称Cipher FeedBack模式，译为密文反馈模式
- 这种工作模式吸收了流加密(流加密可以逐个加密数据，因此适用于流式数据，无需等待整个块加密完成)的特点，可以理解成实现了流加密的CBC 模式
- 加密时，首先对初始化向量（IV）加密，用加密的结果与第一个明文分组异或，得到第一个密文分组
- 然后将此密文分组进行加密（加密前要进行移位处理），将加密结果与第二个明文分组异或

![image-20241223175810153](.\image\image-20241223175810153.png)

- 解密过程与加密过程相似，仍然是将前一密文分组加密**（注意，这里仍然是加密，不是解密）**，用加密结果与当前密文分组异或，得到明文

![image-20241223175851299](.\image\image-20241223175851299.png)

##### 4. **OFB模式** 

- 全称Output Feedback模式，译为输出反馈模式。
- OFB模式与CFB模式类似，区别在于使用上一个分组的密码序列加密生成当前分组的密码序列

![image-20241223175930793](.\image\image-20241223175930793.png)

- 解密过程

![image-20241223175956290](.\image\image-20241223175956290.png)

##### 5. **CTR模式** 

- 全称Counter模式，译为计数器模式。
- CTR模式与CFB、OFB模式为同一类。但它是通过将逐次累加的计数器进行加密来生成密码序列
- 也就是说，每一个的密文分组是通过将计数器加密得到的密码序列与明文分组进行异或而得到的

![image-20241223180045480](.\image\image-20241223180045480.png)

- 解密过程   

![image-20241223180113061](.\image\image-20241223180113061.png)

##### 6. 总结

![image-20241223180138387](.\image\image-20241223180138387.png)

- ECB模式和CBC是最常见的加密模式



### 二. DES算法

实例地址：https://bqcm0.cavip1.com/

简介：**DES**是一种分组**加密算法**，他以`64`位为分组对数据加密。`64`位一组的明文从算法的一端 输入，`64`位的密文从另一端输出。**DES**是一个对称算法：加密和解密用的是同一个算法（除 密钥编排不同以外）。

 密钥的长度为`56`位(密钥通常表示为`64`位的数，但每个第8位都用作奇偶检验，可以忽 略)。密钥可以是任意的`56`位数，且可以在任意的时候改变。

**DES**算法的入口参数有3个：`Key，Data，Mode`。其中`Key`为8个字节共64位，是**DES**算法 的工作密钥；`Data`也为8个字节64位，是要被加密或解密的数据：Mode为**DES**的工作方式，有 两种：加密或解密。

 DES算法的工作过程：若Mode为加密，则用Key对数据Data进行加密，生成Data的密码 形式（64位）作为DES的输出结果；若Mode为解密，则用Key对密码形式的数据Data解密，还 原为Data的明码形式（64位）作为DES的输出结果。
　　 简单地说，算法只不过是加密的一种基本技术，DES基本组建分组是这些技术的一种组合 ，他基于密钥作用于明文，这是众所周知的轮（round）。DES有16轮，这意味着要在明文分 组上16次实施相同的组合技术。

- mode 支持：CBC，CFB，CTR，CTRGladman，ECB，OFB 等。
- padding 支持：ZeroPadding，NoPadding，AnsiX923，Iso10126，Iso97971，Pkcs7 等。

**参考资料：**

- RFC 4772：https://datatracker.ietf.org/doc/rfc4772/
- DES 维基百科：https://en.wikipedia.org/wiki/Data_Encryption_Standard

#### 1. JavaScript 实现

`DES`算法的入口参数有3个

+ `key、DATA、Mode、padding`
  + `key`为`7个字节`共56位，是DES算法的工作密钥
  + `Data`为`8个字节`64位，是要被加密或被解密的数据
  + `Mode`为`DES`的工作方式
  + `padding`为填充模式，如果加密后密文长度如果达不到指定整数倍（8个字节，16个字节），填充

```JavaScript
// 引用 crypto-js 加密模块 
var CryptoJS = require('crypto-js')

function desEncrypt() {
    var key = CryptoJS.enc.Utf8.parse(desKey),
        iv = CryptoJS.enc.Utf8.parse(desIv),
        srcs = CryptoJS.enc.Utf8.parse(text),
        // CBC 加密模式，Pkcs7 填充方式
        encrypted = CryptoJS.DES.encrypt(srcs, key, {
            iv: iv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        });
    return encrypted.toString();
}

function desDecrypt() {
    var key = CryptoJS.enc.Utf8.parse(desKey),
        iv = CryptoJS.enc.Utf8.parse(desIv),
        srcs = encryptedData,
        // CBC 加密模式，Pkcs7 填充方式
        decrypted = CryptoJS.DES.decrypt(srcs, key, {
            iv: iv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        });
    return decrypted.toString(CryptoJS.enc.Utf8);
}

var text = "I love Python!"       // 待加密对象
var desKey = "6f726c64f2c2057"    // 密钥
var desIv = "0123456789ABCDEF"    // 初始向量

var encryptedData = desEncrypt()
var decryptedData = desDecrypt()

console.log("加密字符串: ", encryptedData)
    console.log("解密字符串: ", decryptedData)

// 加密字符串:  +ndbEkWNw2QAfIYQtwC14w==
// 解密字符串:  I love Python!
```



#### 2. Python 实现

```python
pip install pyDes
```



```python
import binascii
# 加密模式 CBC，填充方式 PAD_PKCS5
from pyDes import des, CBC, PAD_PKCS5

def des_encrypt(key, text, iv):
    k = des(key, CBC, iv, pad=None, padmode=PAD_PKCS5)
    en = k.encrypt(text, padmode=PAD_PKCS5)
    return binascii.b2a_hex(en)

def des_decrypt(key, text, iv):
    k = des(key, CBC, iv, pad=None, padmode=PAD_PKCS5)
    de = k.decrypt(binascii.a2b_hex(text), padmode=PAD_PKCS5)
    return de

if __name__ == '__main__':
    secret_key = '12345678'   # 密钥
    text = 'hello world'   # 加密对象
    iv = secret_key           # 偏移量
    secret_str = des_encrypt(secret_key, text, iv)
    print('加密字符串：', secret_str)
    clear_str = des_decrypt(secret_key, secret_str, iv)
    print('解密字符串：', clear_str)


# 加密字符串：b'302d3abf2421169239f829b38a9545f1'
# 解密字符串：b'I love Python!'
```

- 由于库和版本的不同,同样的加密算法在不一样的语言里结果可能不一致,做逆向时最好是选用node来加密网站数据,不使用python来进行加密





#### 3. 实操练习1

##### 1. 逆向目标

首页：https://www.endata.com.cn/BoxOffice/BO/Month/oneMonth.html

数据：https://www.endata.com.cn/API/GetData.ashx

逆向：加密数据

##### 2. 逆向分析

###### 1. 加密数据定位

- xhr断点数据地址
  - 当前获取的数据是加密的信息,那么在发送ajax的时候一定会在处理响应数据的时候对加密数据进行处理,我们可以直接定位到发送ajax请求的位置,看处理数据的函数   

![](images\013.png)

- 关键字定位
  - 获取的是加密的数据信息,在js是一定要进行解密的处理我们可以直接搜索关键字`decrypt`(关键字搜索的范围比较广,可以多打断点,在重新触发任务看是否能断在)

![](images\014.png)

- 网址定位
  - 根据部分网址有时也能定位成功

###### 2. 加密代码分析

- 根据我们xhr的分析可以定位到他是对数据用`webInstace.shell`进行了解密,我们可以直接跟进函数,看函数做了什么事情

![](images\015.png)

- 补js代码(缺什么补什么,要是像这种就是一个单独一个文件的可以全扣)

###### 3.逆向结果

- JavaScript代码

```JavaScript
var ynfqt = '__0x2fb9f'
  , __0x2fb9f = ['w61yEQYNMcKN', 'UcK/IcOnwpLDkMO5', 'wpbCnjvCvwIaPcOxw7E=', 'w5vDizcu', 'w5LCtBs=', 'JcOreTk=', 'w6HCnjp/Tg==', 'KsOkw50FMQ==', 'w7zDqMOCUXI=', 'w7PCp3lkwokmw6oCXg==', 'CsOyczTDtcKlwpbDqUk=', 'GsKYbsK/w7g=', 'wr/DjhgJcA==', 'UlXChFNH', 'PsO7w4gKwrI=', 'Bn/DrcOrwqrDk8OQAA==', 'w47CtsK5wp7Djw==', 'wr3DsWHCtlk=', 'aGjCjlZF', 'T8KPCsOJBA==', 'w7LDqH7CrsKIMg==', 'MMOvw4UzBA==', 'YsKdIFsz', 'wo3DmcOGwpJn', 'NMOfeXdM', 'wofDicOuwrlS', 'wrlFcFrCvg==', 'wphSd8OrLg==', 'w6XDqFDCk8Ke', 'FMO8AsOFBQ==', 'wqrCtCPCnAw=', 'wpTDj3BHEw==', 'DcOHMcOEDQ==', 'fjsAwp/Chg==', 'HMKaQsKnw4Y=', 'w5otSMKBYQ==', 'w6PCkcK8woTDu0jCiWJRNkI=', 'ScK3wrXCmMOr', 'wonDgBIrc8O/XsOiA8KsXlHDmg==', 'woHCpcKCwpTDncKZFH/CocOVw68=', 'w5/Dh8Olflw=', 'w50owowb', 'bcKsD8On', 'w5/CmcK+wp4=', 'EMKOwqc5', 'NsK5d8Kmw6Y=', 'wr7DqMOnwpdg', 'WcKQWz/Dtywi', 'aE8ww6had8O2', 'w5ZPw7bCskY=', 'w6PClMKQwp7Dh17CgA==', 'U8KRw7fCvyoFw4bDgQ==', 'eHcfw6tP', 'NcOOw5w7EA==', 'wpfDkDs7bw==', 'V8KsK8OfwrE=', 'f8KUw5LCkTwSw4g=', 'wqRrdUXClXZo', 'w5zCp1R8wokxw7g=', 'w6zCn0ta', 'w7olTcK8', 'w6U8w5Bs', 'KcOtw7QPwrc=', 'w4nCgwp3UsOnOA==', 'w4nCkjp+XMOwNnAYbUbCrxU=', 'w53CtsKn', 'PsOgflZX', 'c8KbO8OHBQ==', 'w4bClFdkwp4=', 'LmPDqsOtwpI=', 'w5nDlTUgSMKaGsOlw5w/QnxnwpXCpQ==', 'wph1UkjCjnA=', 'w6TDvGPCqMKD', 'w6XDgzUyDg==', 'w7liwrDDqi/DgDTChMKiw54yeMOzwrnCtg==', 'wr3CvsKJwoPDusKJ', 'C0LDrkzDgw==', 'wonDgBgbMg==', 'wrXDlhgJdcOja8O4IsKySELDhcKWw7k=', 'DMOaCMO2KQ==', 'w6jClsK1wqDDow==', '5Lqa6IGt5Yiq6ZqvwpU5U3/CpMOHfsO2w5A=', 'SFXDjsKaw7E=', 'DcKzwrLDv8KL', 'fFjCjFBVw6/DjsOZw5HCoVVe', 'Y8KSeiHDoT89w4VEw7DDicOX', 'wqXClCrCqToYO8OSw6TDisOtSg==', 'w6JSw5fChjU=', 'JcOkeTPCqw==', 'N8O8w6QJwp/CjBvCllrDs8OKTQ==', 'J0rDolzClQ==', 'FcOyw592w4zCncKow5jCuizCqsKU', 'LsOzw5l3woc=', 'w7fDj8OBwpFKKsKxw7NpKjl2', 'woV0VcOrWw==', 'JsOEw40tGk7DnQdoEUvCjQ==', 'w6JVw4DCkGZhZWfCrg7Dp8O5Bg==', 'dcKJeyDDrD0=', 'McOUw4wsF0w=', 'wrhFecORCw==', 'w6osRMK8bA==', 'e8K+wrfCpcOG', 'A8K3Rg==', 'HcORw5wwAFvDmjY=', 'woDDqRAEZA==', 'CcOwcCnDrg==', 'M8KVcg==', 'wq7DucOU', 'w63DoMOv', 'KW3DvA==', 'J8K7QsKEwrg=', 'Y8KuHMKL', 'cHYlw4JT', 'w79LAw0z', 'w5hYw5E=', 'W8K5BcKz', 'w41Xw4DChmI=', 'w408woIEdsKCw7ldMw==', 'G8KjwpM4RA==', 'E8OXEsOhBcO1KsObd38U', 'w7zCi0VFG8KS', 'Y8KSeg==', 'w4nCi8K3woDDqVrCjkdA', 'KcONw7TDsyY=', 'w7s/wqfDlnU=', 'aFnCgm9H', 'w6rDt8OpwrRk', '5Lqb6ICM5Ymo6Zm/TsOrOUsSbxjCvFI=', 'JsO3w6MewoDClQHCsVI=', 'w6HDjsOIwpBcNMOrw4cw', 'TAsowpjCrXlTwoXCgg==', 'wot1WF3ClWF6IcOH', 'Z8KcwpA=', 'w7jDhiMk', 'KkPDqg==', 'DMOCE8O8IsO8', 'HsOtw45Vw4M=', 'w7APwrQNZQ==', 'w7TCgMKiwoPDnA==', 'w50Cd8KVbg==', 'KW3DqsO6woQ=', 'w6TCvGJiIg==', 'w6HDkcOOwopH', 'DsOAw4PDlgc=', 'wqnCkDrClDQGH8Oiw6fDlcOrU2kn', 'dcKFdxfDmw==', 'w4oKwrcmZA==', 'w6MjwprDkg==', 'FsOYCMOh', 'w5XClsK7woY=', 'GAoywpzCp38=', 'ScKpGMO/', 'wqjDgU/CtkPCmQ==', 'w6LCpWZ8wp8=', 'wqXDmEjCnFrCk8OmwpZcwpzDvgPDvlc=', 'L8OIbSPDjA==', 'w6bDjsOxwpdBM8Krw5Y=', 'w7ofwqI=', 'asOlwrYHw5bCgFjCqATDoMKcWhhvT0jCkMOyIA==', 'w7hYKzAr', 'IMOpw6sSwpI=', 'N0nDj8Ogwq8=', 'w7DCnMKowqTDrA==', 'AmUoBMOkw7U=', 'w5PCjsK0wrDDjg==', 'EMO2w6M8wqI=', 'w7rClCZ8ScOs', 'eDwU', 'w70hQsKiecOhwok=', 'w6l6RG1X', 'a8KTfTY=', 'w7ddEQ==', 'w7oswpc=', 'IcO8w593woI=', 'w4ZxAB4QO8KIw5Y=', 'PMKSwoDDpcO3', 'VUXDrsKDw7wnw7DDrELDq3Y=', 'UlMR', 'I8O4w7UIwoM=', 'GsOYAg==', 'wpjDjV3Dqw==', 'w6LDgMOQwpBW', 'w4/DlDUzfcKYOsOlw4s=', 'wpJpXl0=', 'GsOOFcOwIsO/', 'T1LCnUZtw63DiMO6w4Q=', 'wp5/Q0zClHE=', 'w4bCkgs=', 'w4nCu1xFwoI=', 'R3jCoWFzw4fDvMOUw6/Cg2l4LsK+w4E=', 'wr7DkFzCkVTCicOTwpc=', 'wpsBB8KXHg==', 'TMKdw77CmicZ', 'w7ZtGQ==', 'w5tZdUlZ', 'w4bCm0VcGw==', 'woTDtBUSTA==', 'RcKuCMOaE8OVL0PChQ==', 'bTAtwpfDvQ8Y', 'wphmW0U=', 'w5U9woHDg2RGWHAsbA==', 'dcKBw5nCiSE=', 'wo9KwofCiTRpMVPDux7Cow==', 'bkTCgUBh', 'VcKwFsOKLA==', 'GsOow4shwpU=', 'K3TDt8OFwrs=', 'OMOnKMO4JQ==', 'w5Bgw6PCs3I=', 'wp/DlTEycg==', 'MV/Di3XDlQ==', 'w7jCkVVSHA==', 'w6DCuXd9wpY=', 'CcOpewLDo8KlworDqg==', 'BMK5RsK1w7YOWMKd', 'UVwBw6tF', 'CsOpSDnDuA==', 'w6DCsH98', 'BsOdw7nDjC8=', 'w7hfIQ==', 'w7tXcnhq', 'McK2wrvDoA==', 'woxoRU3CiQ==', 'D0HDtUvDlQ==', 'wqXDiBQLZA==', 'dsKWw6jChx0=', 'Wj0g', 'w7HCnxB9bA==', 'CljDisOYwqI=', 'HsOuflZw', 'LVjDssOfwpk=', 'w4rDi8OqwrNy', 'w4pPZE9x', 'w49+wrHDsRk=', 'w49Xw5zCkWh4', 'wpXDtDkJVw==', 'fMKsDcOvwpLDng==', 'w7Yow49o', 'WcKvN8O6woQ=', 'wo/DgExRJw==', 'wrvCosKP', 'N8OTGQ==', 'AMKGwqwXXE/CtcOa', 'wr7DgV15Pg==', 'w6LDgxgbew==', 'w7vDr8Ox', 'dAM2woDCiw==', 'C8Oww5TDiS8=', 'LW4tD8Ob', 'w70nwosbSQ==', 'w4HCkxxqRA==', 'XHHDssKDw5E=', 'dcK0EcOfNg==', 'w4lZw6HCgXV8bkg=', 'wqbDkQ4A', 'wq5/Y8OsGB9Kw64=', 'DWEqDw==', 'w7HDjcONwo1W', 'w4TDhsODekEE', 'QEvCmER5', 'dn7CnlJN', 'w4XDssORwplC', 'w7k4wpHDlWZ2', 'w5scwo8DZg==', 'w43Dl8OvTnM=', 'wqfCgybCtgAALsOiw4vDisOqRA==', 'ScKjwqXCp8Oc', 'w4XCnMKxwpTDog==', 'w6AiwprDiA==', 'HcOyw5Jjw4HChQ==', 'woJmR8O+Pw==', 'w513woXDhjI=', 'KMOlEsOvPQ==', 'w7BYV1xE', 'w7osQMKiQ8O+wpnCvMKDMQ==', 'w6zDhMOHeUE=', 'cVPChlY=', 'w6F1Fg==', 'NMOEWQ==', 'XWfCuU1d', 'AcOHw4hJw4M=', 'YsKQPsOJNA==', 'w5zDjMOId3g=', 'w5k5w5lzwrk=', 'OMOsdnEq', 'woLDucOPwqdRVMOte2zChcOASw==', 'w6Mzw59yw7HCjMOxa8OHwr/DuMO8', 'wpPCoRvCqjo=', 'SUXDr8KEw5A=', 'w6s5w7tww6Q=', 'UVIAw6lUYA==', 'w6jCsXA=', 'bsKNwpfCiMOaw58x', 'YsKDwqHCgsOVw44=', 'wrLDgR4aeMO2Wg==', 'e1zCg04=', 'GsOyw4U=', 'wqTDgkx5DsKDYMO2RsKgw7shw5sMJlYcICl1YMK6', 'FMOvw4hhw5vCiQ==', 'Yx0mwpjCow==', 'YsKbwpvCnw==', 'MW4CAsOkw7zCmcKMZMKCLw==', 'S8KBKg==', 'w50pdMK+Yg==', 'wrN+Wg==', 'OsOrw5c4MQ==', 'w7TDom/CqsKSMw==', 'w5zCshlvSw==', 'wpXDqMOewrxGQw==', 'ecK2MXgf', 'wqRjVl3Cmw==', 'bcKiDcOowpzDhw==', 'w6otRsKSecOlwpjCqg==', 'wrhzXw==', 'Y8OlwrUHw5LCgF7CqAU=', 'wrLCgSXCsjc=', 'UcKpAsO/wpw=', 'w7kkwpTDpGtwUWw=', 'E8O7w5Nnw57CvsK1w6DCsw==', 'AG/DtUHDhw==', 'UTYtwos=', 'w59/Kw==', 'HsKdwoMNcQ==', 'w5DCk05YLcKVT8Okwr4NAXDDusO2', 'w7pXw6HCsWk=', 'JcOKcUp5', 'w7U0w5tCw7HCiMOgWg==', 'w6EqwokHasKVw6I=', 'w5lTw5HCh35ldG3Cpw3DtMO3', 'w7/CnyFv', 'wrXDhREE', 'LsOzw51ww5Q=', 'GcOscy7Dvw==', 'UkUGw6FbcA==', 'wrd8eA==', 'T8K/N8OIwrQ=', 'XRYTwpLDhg==', 'KcOxw68Cwq8=', 'bcKrBA==', 'dkjCm0pF', 'w5UhwrHDin1nXw==', 'f8KKw5LCkTwSw4g=', 'KMKiY8Kbw6AZVg==', 'wqPCvSg=', 'w5MHwroxdg==', 'w7MuwrvDp3k=', 'w7TCvSk=', 'w6Etwo8ncMKfw7NWJ8Kgw4Ybw4jDrjc=', 'RFQVw4ZMYMO4w6s=', 'A8Oyw49hw4E=', 'PMOIw4vDrwwNwp4=', 'UcKsE8O7wpjDncO2', 'wozDvBE=', 'LXrDgcONwpU=', 'w44nwrQ=', 'R8KNJw==', 'U8K5w4LCjRY=', 'I8OCw4lAw7c=', 'Vk4iw41l', 'bTcrwqHDvAQLe8Kdw4N8', 'GsKBwqIh', 'w6XCvHhxwoo7w6kX', 'HcKJdw==', 'wpjDggQrTw==', 'F2rDocOKwq8=', 'HkfDqU7DisOVw4DDjg==', 'NcOJw6I=', 'FMK7RcKNw74=', 'X8K0E8OH', 'LcK/aMK8w40=', 'XMK8woHCg8OA', 'WTscwrHDgg==', 'wpLCpsKawqzDpw==', 'wp0BG8KHEA==', 'w6NSwq/DpzI=', 'w53Coh5MVA==', 'FsKAwpjDjcOe', 'd8KPGcOnwpQ=', 'BMKswoAfSg==', 'wrjCszPCtyo=', 'FMOgw6jDrQg=', 'BcKxT8KTw6AX', 'wpU7PcK4HE4=', 'wqfDk18=', 'w6HDlcOQwopdPQ==', 'P8Oww6U=', 'ScKUwoHCjg==', 'w6rDlsOLe1Aew4FTXQYBw6zCgijDjsKbIMKJNwDDpSc=', 'wr9+Uw==', 'EsKDwqw6', 'K3Y2KMOUw5s=', 'wr9oRMO9BBI=', 'w6Mlw4hlw6bCmA==', 'w7LDh3LCqsKA', 'wozDrcOC', 'w6XCj0k=', 'wrvCtMKYwofDoMKI', 'w5RYw5vCgQ==', 'eU3Cn05V', 'USEhwobDoQ8=', 'w4YJwr4=', 'wrZdVsOgGg==', 'asKlJmoOwp8=', 'woh3W0DCmXA=', 'w5/CnsK1', 'w681wofDg3xg', 'YwEhwoPCsGBnwprCg8KY', 'FcOtYGds', 'AMOIw5fDsw==', 'Yx0owr7Cp35PwoE=', 'R03CnU1Pw7rDicOo', 'w6XDhiAxWcKROw==', 'w6PCnMK9wrTDgVPCikVdNVQ=', 'U8K+UB/DrA==', 'M8KUwrLDncO2', 'w7DCoWR5wog1', 'WRckwp7Cu31e', 'w49+YA==', 'I8KWwr3DlcO4', 'w7ZXw6LCkmU=', 'L8OwJ8OzFA==', 'DMO9w6YPwoc=', 'BmLDnMOowpXDl8OrCsOHQ1Q=', 'w5Zyw6DCoUs=', 'NsOow6AnJw==', 'WBwkwp7Cu31e', 'wpLChTvCviIFDMO5w7jDjcOrUw==', 'wokiP8K/GlnDs8K/', 'w6syw5hl', 'w7ByPAkJEcKPw4ELwoLCsDF2YcKE', 'w5hOw4bCkGlx', 'w4Mzw59yw7HCjMOxRsOZ', 'Q8KKw7XCnCcU', 'GcOyeSHDrsK0', 'J0fDsQ==', 'MMKtwog=', 'wrHCqDw=', 'e8KdMH8y', 'w4nCmD4=', 'woVgQsO9HDRIw6ZeVA==', 'w693wrDDvxE=', 'WAsRwo/ChA==', 'w5lew5DCkmw=', 'HFzDkUzDoA==', 'w4XCnmB+wpU=', 'woNJQMO6LA==', 'wr/Dk2dIKg==', 'wojDrFbCu0s=', 'OMKewr0jYg==', 'UsKmH8OvwonCpg==', 'w5TCnsKWwpbDrQ==', 'DcOXD8OxI8O2', 'w6bChDtz', 'a8K1F8OuwpPDlw==', 'NMO5w592w4zCncKow7XCpA==', 'wonDhxQYacOjXA==', 'w6Qxw5Njw6PCr8OsU8OO', 'EsK+QsKFw7YKScKsw7zCg8K2Kg==', 'EMOFw5LDvAw=', 'BsOEw40tGk7DnSp2', 'VyswwoLDuw4=', 'w43DgsOLwpNbP8K3', 'w5wlwo8UacKjw7lJMQ==', 'SkjDtMKUw5A=', 'A8OtcHBhc8KLw6g6KwTDpw==', 'JcOwbiXDrMKTwoPDtk/CqA==', 'wpbDvcOI', 'w6zCk8KxwoHCnw==', 'U8K3KcOkJw==', 'w6pyUVxLwrJhw5g=', 'FsK/bcKhw7Y=', 'w5cZw6xzw4w=', 'e8KcLkkb', 'KMOqYVJP', 'QcKvEcObwqo=', 'AMObw57Dvh0G', 'w7p0WH1TwrI=', 'w4nDrio=', 'wojDqFrCtXw=', 'wp7CkDnCqyYGKw==', 'acKqCMOcHsOXNVY=', 'JMO2w7UfwpU=', 'wqnDqsOKwrRF', 'FcO1w5Mzwo0=', 'w5dmJw8MNg==', 'DWYh', 'w5rCk8Kc', 'TcKpD8ObwoQ=', 'wr4zPsKfDlLDkMK+bMKLwqHCosOUw78=', 'w7Iyw690w7rClcOrTg==', 'w65/wobDvynDjB/CjQ==', 'wrU0Kg==', 'ZMK4J24=', 'KcOhcFdN', 'WcKEfzzDqiIEw6hMw7o=', 'acK3E8OdP8OHIEPCmcKrwqHDkcO+Ig==', 'VsK6LG8f', 'wp7CnCbCvyY=', 'w6XDjsOQwodA', 'w4vCl8KgwpbDmw==', 'BmHDt8OtwoQ=', 'wonDux4aZMOnWsO5Mw==', 'w4rDlT8iWcKMLMOJw5MiWGc=', 'w69iwr0=', 'w7bCp34=', 'Q8Kew7c=', 'wotmU03Ck3tk', 'w7fDm8OLckcBw6lYew8=', 'AcOFw5TDvAIwwpPDtn0=', 'bSM2wojDtg8ZZA==', 'w53DjcOdfFE=', 'woJiZxZQLsOTw41SwpvDsQ==', 'w5sxwpQSbMKU', 'NGXDoMOAwo8=', 'S8KjFw==', 'FsKXwq42UE/CtQ==', 'wpBiTnrCk29m', 'w77DplnCosKcMw==', 'w5/DiTMzRcKPKw==', 'WkXDscKb', 'wrF1SQ==', 'W1TCn0pJw63DqsO6w4/Cr1tG', 'C3gyBsO+w7k=', 'ZsKcworCosOB', 'HsKHwoQ=', 'AsK+dsKQw6o=', 'Vwg1woLCow==', 'woDDmFhyCsKFccO3dg==', 'IMOtw7USwojCmwbCsk8=', 'wo7CvMK8wrTDrA==', 'wrLCuj3CrwU=', 'w7kGwofDklQ=', 'wrjCo8Kewo/Dr8KY', 'G0fDt0fDg8OOw47Djh5o', 'dcKddSc=', 'e1LCgUFNw6s=', 'ccKTazfDqw==', 'd8KoPsOlBA==', 'w4DCrnV7Hg==', 'wpPDukxMBw==', 'LMKLwqohRA==', 'wqE9P8K0Cg==', 'wrLCmC7CmTocKsOj', 'woHDuHPCvko=', 'w5XCtsKEwqjDnA==', 'w7HDhMOLwo8=', 'w6s8w4Q=', 'GcKywoLDpMOK', 'w43DjMOLwo1xL8Kjw5dgNwl0w7dT', 'wqzCmCc=', 'YMKTBFM9', 'w4nClSdLT8OrMF0OcnTCpgjCuVA=', 'KnzDtMOgwoLDkw==', 'GMO5w5Vw', 'w4/CkcK1wrDDkUnCjlo=', 'WlbDuMKWw4Es', 'GcOfD8O0IMOyNMOb', 'VFsV', 'Xwsiwo3Ctmg=', 'b8K4MWYbwo4=', 'VxQg', 'w4Rsw6DCmFI=', 'P2PDtXzDoA==', 'wonDlBwacsOj', 'w5rCl8Kgwp/DiUk=', 'w5R3PQsOO8Kcw5Q=', 'IcOIw543BkzDnSB8Cg==', 'w5HCllVfwqM=', 'HmE0EMO1', 'wr3DgBs=', 'wqTDhRMMbsOr', 'woXDrsOJwrRcQQ==', 'wpHDs8OewrFb', 'HWwvAMO1', 'w7zCl0B0FsKUTMOx', 'wqYxIMKTEQ==', 'w4LDgMORwpBENcK3w5VHJCl4w6l1wobDhcOgb8KG', 'EsKoVcKSw6Ee', 'G0jDoA==', 'w6Qewok=', 'Z8KWWxnDnQ==', 'w6DDsDk=', 'w6lsAcOkWgoQw7UPQw8=', 'a8K1BsOowojDh8O3', 'wqrClDDCiCoSKg==', 'DsO+QGtiZg==', 'w5fDjigIUg==', 'N8KvwqPDqcOXw5s=', 'FMO5w592w4zCncKo', 'w6DCtHp8', 'SMKfPsObwqA=', 'woHDu3PCimA=', 'E0nDhVrDrQ==', 'w57Do8Oqwrp+', 'w4jDrsOtwqxJ', 'wqh0WUbCjg==', 'FcKHQMKmw6o=', 'FMO4f2ts', 'w57DgjMzRcKPKw==', 'wqLCkCXCtw==', 'MXAnEcOjw7g=', 'wrx/QsO1CwI=', 'woPDpMOYwrBGQA==', 'FMOSBw==', 'wo3DucOVwoZBXsO8', 'w5toAAMYNw==', 'wqlxXMOs', 'FEfDpQ==', 'wph8X8O7ATVNw7lVWkg9ccKYbg==', 'w7xjQntcwqI=', 'H8O4aCXDtMK1', 'w5zCtn9gwo43w6E=', 'w5hYw5HCh35ldG3Cpw3DtMO3', 'TcKyIHkDwoooZnE=', 'IMOVCMOlJMO+PA==', 'wqXDncOE', 'w6bDt1nCpsKg', 'M0bDnsOFwrY=', 'MWwED8O/w77CsA==', 'w4Y2Y8K8b8OywpY=', 'ZkjDn8Kbw5oqw78=', 'bkfDrcKcw4A=', 'w6t3wobDph0=', 'EcO5WAfDmw==', 'a8K0VhvDrw==', 'w6XDlRItU8KcNA==', 'VsK7AWcVwpk3'];
(function(_0x13ecc8, _0x3e2859) {
    var _0xd14b57 = function(_0x91fb5e) {
        while (--_0x91fb5e) {
            _0x13ecc8['push'](_0x13ecc8['shift']());
        }
    };
    _0xd14b57(++_0x3e2859);
}(__0x2fb9f, 0x80));
var _0x2246 = function(_0x5c2ba4, _0x76e2e) {
    _0x5c2ba4 = _0x5c2ba4 - 0x0;
    var _0x32e905 = __0x2fb9f[_0x5c2ba4];
    if (_0x2246['initialized'] === undefined) {
        (function() {
            var _0x6dc9dd = typeof window !== 'undefined' ? window : typeof process === 'object' && typeof require === 'function' && typeof global === 'object' ? global : this;
            var _0x4dc154 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
            _0x6dc9dd['atob'] || (_0x6dc9dd['atob'] = function(_0x2e7e78) {
                var _0x27fca7 = String(_0x2e7e78)['replace'](/=+$/, '');
                for (var _0x443da7 = 0x0, _0xd245ea, _0x20728f, _0x1a79d3 = 0x0, _0x2add8f = ''; _0x20728f = _0x27fca7['charAt'](_0x1a79d3++); ~_0x20728f && (_0xd245ea = _0x443da7 % 0x4 ? _0xd245ea * 0x40 + _0x20728f : _0x20728f,
                _0x443da7++ % 0x4) ? _0x2add8f += String['fromCharCode'](0xff & _0xd245ea >> (-0x2 * _0x443da7 & 0x6)) : 0x0) {
                    _0x20728f = _0x4dc154['indexOf'](_0x20728f);
                }
                return _0x2add8f;
            }
            );
        }());
        var _0x9bf5c5 = function(_0x29e5a4, _0x4e0418) {
            var _0x317a0c = [], _0x58cb6f = 0x0, _0x1ef9fa, _0x2b84ff = '', _0x406a41 = '';
            _0x29e5a4 = atob(_0x29e5a4);
            for (var _0x5e728c = 0x0, _0x36a9ad = _0x29e5a4['length']; _0x5e728c < _0x36a9ad; _0x5e728c++) {
                _0x406a41 += '%' + ('00' + _0x29e5a4['charCodeAt'](_0x5e728c)['toString'](0x10))['slice'](-0x2);
            }
            _0x29e5a4 = decodeURIComponent(_0x406a41);
            for (var _0x3895f0 = 0x0; _0x3895f0 < 0x100; _0x3895f0++) {
                _0x317a0c[_0x3895f0] = _0x3895f0;
            }
            for (_0x3895f0 = 0x0; _0x3895f0 < 0x100; _0x3895f0++) {
                _0x58cb6f = (_0x58cb6f + _0x317a0c[_0x3895f0] + _0x4e0418['charCodeAt'](_0x3895f0 % _0x4e0418['length'])) % 0x100;
                _0x1ef9fa = _0x317a0c[_0x3895f0];
                _0x317a0c[_0x3895f0] = _0x317a0c[_0x58cb6f];
                _0x317a0c[_0x58cb6f] = _0x1ef9fa;
            }
            _0x3895f0 = 0x0;
            _0x58cb6f = 0x0;
            for (var _0x49f219 = 0x0; _0x49f219 < _0x29e5a4['length']; _0x49f219++) {
                _0x3895f0 = (_0x3895f0 + 0x1) % 0x100;
                _0x58cb6f = (_0x58cb6f + _0x317a0c[_0x3895f0]) % 0x100;
                _0x1ef9fa = _0x317a0c[_0x3895f0];
                _0x317a0c[_0x3895f0] = _0x317a0c[_0x58cb6f];
                _0x317a0c[_0x58cb6f] = _0x1ef9fa;
                _0x2b84ff += String['fromCharCode'](_0x29e5a4['charCodeAt'](_0x49f219) ^ _0x317a0c[(_0x317a0c[_0x3895f0] + _0x317a0c[_0x58cb6f]) % 0x100]);
            }
            return _0x2b84ff;
        };
        _0x2246['rc4'] = _0x9bf5c5;
        _0x2246['data'] = {};
        _0x2246['initialized'] = !![];
    }
    var _0x4b1179 = _0x2246['data'][_0x5c2ba4];
    if (_0x4b1179 === undefined) {
        if (_0x2246['once'] === undefined) {
            _0x2246['once'] = !![];
        }
        _0x32e905 = _0x2246['rc4'](_0x32e905, _0x76e2e);
        _0x2246['data'][_0x5c2ba4] = _0x32e905;
    } else {
        _0x32e905 = _0x4b1179;
    }
    return _0x32e905;
};

var _grsa_JS = _grsa_JS || function(_0x1ced32, _0x5ecf19) {
    var _0x10331a = {
        'CnklK': function _0x3e62ec(_0x1d5911, _0x194e2e) {
            return _0x1d5911 >>> _0x194e2e;
        },
        'fasop': function _0x309160(_0x42d8e6, _0x1f95a5) {
            return _0x42d8e6 << _0x1f95a5;
        },
        'piTyb': function _0x16701f(_0x52ec0c, _0x1d6252) {
            return _0x52ec0c % _0x1d6252;
        },
        'etBSF': function _0x5b4bf4(_0x4f888b, _0x7a8d8) {
            return _0x4f888b / _0x7a8d8;
        },
        'CPDaV': function _0x4f38e0(_0x167032, _0x557588) {
            return _0x167032(_0x557588);
        },
        'WbTqy': function _0xe7e714(_0x15ea20, _0x26c93d) {
            return _0x15ea20 * _0x26c93d;
        },
        'ibfMy': function _0x2dac36(_0x5b0802, _0x23eb9b) {
            return _0x5b0802 | _0x23eb9b;
        },
        'iwfNL': function _0x1cc18f(_0x1470bc) {
            return _0x1470bc();
        },
        'XvwfU': function _0x1446ba(_0x4435ab, _0x2c405c) {
            return _0x4435ab < _0x2c405c;
        },
        'XdHZG': function _0x3b9f93(_0x82620d, _0x117ba6) {
            return _0x82620d === _0x117ba6;
        },
        'HzqlI': 'iNS',
        'hYoVF': function _0x399937(_0xed7e40, _0x4311a3) {
            return _0xed7e40 & _0x4311a3;
        },
        'eUotd': function _0x1f9d76(_0x53718e, _0x504f72) {
            return _0x53718e % _0x504f72;
        },
        'sUmiI': function _0x536f6e(_0x5b7a44, _0x2523d9) {
            return _0x5b7a44 & _0x2523d9;
        },
        'nCqpa': function _0x537c09(_0x36091f, _0x69507f) {
            return _0x36091f >>> _0x69507f;
        },
        'WSszq': function _0x267fc2(_0x76deda, _0x5cedd3) {
            return _0x76deda << _0x5cedd3;
        },
        'LWyHk': function _0x678ebd(_0x29c9b6, _0x2d98ca) {
            return _0x29c9b6 & _0x2d98ca;
        },
        'nNKsT': function _0x21c3e9(_0x594cba, _0x5afd7a) {
            return _0x594cba >>> _0x5afd7a;
        },
        'BVWLs': function _0x9d7bf3(_0xc1dadc, _0x1d72f1) {
            return _0xc1dadc >>> _0x1d72f1;
        },
        'ydcfJ': function _0x2962c4(_0x33c44f, _0x19940f) {
            return _0x33c44f - _0x19940f;
        },
        'Dgjdt': function _0x145c4f(_0x5c4219, _0x3cb60c) {
            return _0x5c4219 * _0x3cb60c;
        },
        'GgPMi': function _0x84affb(_0x5a70b9, _0x565471) {
            return _0x5a70b9 >>> _0x565471;
        },
        'iCaBv': function _0x3edc5b(_0x4ef4d9, _0x1cf391) {
            return _0x4ef4d9 & _0x1cf391;
        },
        'XcXUw': function _0x583c5b(_0x24419a, _0x459a1b) {
            return _0x24419a % _0x459a1b;
        }
    };
    var _0x58dcba = Object['create'] || function() {
        function _0x4a0f25() {}
        return function(_0x427b60) {
            _0x4a0f25[_0x2246('0x2', '4mX2')] = _0x427b60;
            _0x427b60 = new _0x4a0f25();
            _0x4a0f25[_0x2246('0x3', 'fniG')] = null;
            return _0x427b60;
        }
        ;
    }()
      , _0x5a867b = {}
      , _0xd07f = _0x5a867b[_0x2246('0x4', '@1Ws')] = {}
      , _0x778d4 = _0xd07f[_0x2246('0x5', 'OMJW')] = function() {
        var _0x1a3d16 = {
            'uIGrR': function _0x3cd273(_0x4e71fc, _0x1e5711) {
                return _0x4e71fc === _0x1e5711;
            },
            'ozrQv': 'FkU',
            'NFTzg': _0x2246('0x6', '7IfV'),
            'Hxpqt': function _0x3181a8(_0x2e90cf, _0x15d758) {
                return _0x2e90cf == _0x15d758;
            },
            'DFVEn': _0x2246('0x7', '0J6f')
        };
        if (_0x1a3d16['uIGrR'](_0x1a3d16[_0x2246('0x8', 'ORle')], _0x1a3d16[_0x2246('0x9', 'cs*4')])) {
            return _0x1a3d16[_0x2246('0xa', '0I#o')](_0x1a3d16[_0x2246('0xb', 'nArV')], typeof a) ? c[_0x2246('0xc', '7IfV')](a, this) : a;
        } else {
            return {
                'extend': function(_0x5114ee) {
                    var _0x4ae38a = {
                        'kBETM': '5|0|1|4|3|2',
                        'synDC': 'init',
                        'tCWQf': function _0x3006e5(_0x4570e3, _0x4b170c) {
                            return _0x4570e3 !== _0x4b170c;
                        }
                    };
                    var _0x5826b6 = _0x4ae38a[_0x2246('0xd', 'UwHa')][_0x2246('0xe', 'yY#5')]('|')
                      , _0x37a510 = 0x0;
                    while (!![]) {
                        switch (_0x5826b6[_0x37a510++]) {
                        case '0':
                            _0x5114ee && _0x2cbd04[_0x2246('0xf', 'Yb4P')](_0x5114ee);
                            continue;
                        case '1':
                            _0x2cbd04[_0x2246('0x10', 'gc3h')](_0x4ae38a[_0x2246('0x11', '4VZ$')]) && _0x4ae38a[_0x2246('0x12', 'cs*4')](this[_0x2246('0x13', 'BQ5p')], _0x2cbd04[_0x2246('0x14', '0J6f')]) || (_0x2cbd04[_0x2246('0x15', '0I#o')] = function() {
                                _0x2cbd04['$super']['init']['apply'](this, arguments);
                            }
                            );
                            continue;
                        case '2':
                            return _0x2cbd04;
                        case '3':
                            _0x2cbd04[_0x2246('0x16', '4mX2')] = this;
                            continue;
                        case '4':
                            _0x2cbd04[_0x2246('0x17', 'lav3')]['prototype'] = _0x2cbd04;
                            continue;
                        case '5':
                            var _0x2cbd04 = _0x58dcba(this);
                            continue;
                        }
                        break;
                    }
                },
                'create': function() {
                    var _0x6b5022 = this[_0x2246('0x18', 'KuWu')]();
                    _0x6b5022['init'][_0x2246('0x19', 'R*c1')](_0x6b5022, arguments);
                    return _0x6b5022;
                },
                'init': function() {},
                'mixIn': function(_0x349825) {
                    var _0x3e6f37 = {
                        'UHqcV': 'toString'
                    };
                    for (var _0x3e79bb in _0x349825)
                        _0x349825['hasOwnProperty'](_0x3e79bb) && (this[_0x3e79bb] = _0x349825[_0x3e79bb]);
                    _0x349825[_0x2246('0x1a', 'KuWu')](_0x3e6f37[_0x2246('0x1b', ')q#9')]) && (this[_0x2246('0x1c', 'yY#5')] = _0x349825['toString']);
                },
                'clone': function() {
                    var _0x2a3b98 = {
                        'JFxZI': function _0x1d25bb(_0x2bf950, _0x529e5e) {
                            return _0x2bf950 !== _0x529e5e;
                        },
                        'MqexO': _0x2246('0x1d', 'BQ5p'),
                        'lBhNv': _0x2246('0x1e', 'fVzz'),
                        'nEWiN': function _0x59bf51(_0x4317bc, _0x4d7618) {
                            return _0x4317bc + _0x4d7618;
                        },
                        'ovfBf': function _0x1b8b0f(_0x120791, _0x4f4dc3, _0x26eb2e) {
                            return _0x120791(_0x4f4dc3, _0x26eb2e);
                        },
                        'LdzVD': function _0xc3c342(_0x522a87, _0x1879c9) {
                            return _0x522a87 - _0x1879c9;
                        },
                        'keXtu': function _0x439cef(_0x29e4af, _0x568522) {
                            return _0x29e4af == _0x568522;
                        },
                        'CodGD': function _0x941ce5(_0x1a7663, _0x270568) {
                            return _0x1a7663 >= _0x270568;
                        },
                        'axoMS': function _0x321878(_0x1d63c4, _0x23b077, _0x4ffd59, _0x4d841b) {
                            return _0x1d63c4(_0x23b077, _0x4ffd59, _0x4d841b);
                        }
                    };
                    if (_0x2a3b98[_0x2246('0x1f', '!2eC')](_0x2a3b98['MqexO'], 'pRQ')) {
                        var _0x41a60d = _0x2a3b98['lBhNv'][_0x2246('0x20', 'fVzz')]('|')
                          , _0x21997c = 0x0;
                        while (!![]) {
                            switch (_0x41a60d[_0x21997c++]) {
                            case '0':
                                var _0x1722c1 = _0x2a3b98[_0x2246('0x21', '7IfV')](_0x2a3b98['ovfBf'](parseInt, _0x5ecf19[_0x2a3b98[_0x2246('0x22', '0I#o')](_0x5ecf19[_0x2246('0x23', 'LKuf')], 0x1)], 0x10), 0x9)
                                  , _0x574f34 = _0x2a3b98[_0x2246('0x24', '0I#o')](parseInt, _0x5ecf19[_0x1722c1], 0x10);
                                continue;
                            case '1':
                                if (_0x2a3b98['keXtu'](null, _0x5ecf19) || _0x2a3b98[_0x2246('0x25', 'fVzz')](0x10, _0x5ecf19[_0x2246('0x26', 'fDXQ')]))
                                    return _0x5ecf19;
                                continue;
                            case '2':
                                _0x1722c1 = _0x5ecf19['substr'](_0x574f34, 0x8);
                                continue;
                            case '3':
                                _0x1722c1 = _grsa_JS[_0x2246('0x27', '4mX2')][_0x2246('0x28', 'nArV')]({
                                    'ciphertext': _grsa_JS['enc']['Hex'][_0x2246('0x29', 'sMzu')](_0x5ecf19)
                                }, _0x574f34, {
                                    'iv': _0x1722c1,
                                    'mode': _grsa_JS[_0x2246('0x2a', '4VZ$')][_0x2246('0x2b', '!2eC')],
                                    'padding': _grsa_JS[_0x2246('0x2c', 'BQ5p')][_0x2246('0x2d', 'ORle')]
                                })[_0x2246('0x2e', '!2eC')](_grsa_JS['enc']['Utf8']);
                                continue;
                            case '4':
                                return _0x1722c1['substring'](0x0, _0x2a3b98[_0x2246('0x2f', 'E&5L')](_0x1722c1[_0x2246('0x30', 'rk]M')]('}'), 0x1));
                            case '5':
                                _0x5ecf19 = _0x2a3b98['axoMS'](_0x1ced32, _0x5ecf19, _0x574f34, 0x8);
                                continue;
                            case '6':
                                _0x574f34 = _grsa_JS[_0x2246('0x31', 'Jsmq')]['Utf8'][_0x2246('0x32', 'fVzz')](_0x1722c1);
                                continue;
                            case '7':
                                _0x5ecf19 = _0x1ced32(_0x5ecf19, _0x1722c1, 0x1);
                                continue;
                            case '8':
                                _0x1722c1 = _grsa_JS[_0x2246('0x33', '0J6f')][_0x2246('0x34', 'KuWu')][_0x2246('0x35', 'yY#5')](_0x1722c1);
                                continue;
                            case '9':
                                if (!navigator || !navigator[_0x2246('0x36', 'OMJW')])
                                    return '';
                                continue;

                    var _0x5b8057 = _0x16031e[_0xe14056] - 0x1;
                    _0x18c49c[_0xe14056] = _0x11bbc8[_0x2246('0x1fe', 'E&PI')](_0x24a17c[_0x11bbc8[_0x2246('0x1ff', '&59Q')](_0x5b8057, 0x5)], _0x11bbc8[_0x2246('0x200', 'Z2VK')](0x1f, _0x11bbc8[_0x2246('0x201', 'fVzz')](_0x5b8057, 0x20))) & 0x1;
                }
            }
            _0x24a17c = this[_0x2246('0x202', '7IfV')] = [];
            for (e = 0x0; _0x11bbc8[_0x2246('0x203', '0I#o')](0x10, e); e++) {
                if (_0x11bbc8[_0x2246('0x204', 'KuWu')](_0x11bbc8[_0x2246('0x205', 'Z2VK')], _0x11bbc8[_0x2246('0x206', ']2BX')])) {
                    return this['init']['prototype'][_0x2246('0x207', 'E[6X')](this);
                } else {
                    for (var _0x42a9aa = _0x24a17c[e] = [], _0x5ed64d = _0x166a99[e], _0x17eed7 = 0x0; _0x11bbc8[_0x2246('0x208', 'GL3Q')](0x18, _0x17eed7); _0x17eed7++)
                        _0x42a9aa[_0x11bbc8[_0x2246('0x209', 'O^50')](_0x11bbc8[_0x2246('0x20a', 'sy^o')](_0x17eed7, 0x6), 0x0)] |= _0x11bbc8[_0x2246('0x20b', 's&Ar')](_0x18c49c[_0x11bbc8[_0x2246('0x20c', 'sy^o')](_0x11bbc8[_0x2246('0x20d', 'fniG')](_0x3471c3[_0x17eed7], 0x1) + _0x5ed64d, 0x1c)], _0x11bbc8[_0x2246('0x20e', 'DK[&')](0x1f, _0x11bbc8['aUBlz'](_0x17eed7, 0x6))),
                        _0x42a9aa[_0x11bbc8[_0x2246('0x20f', 'E[6X')](0x4, _0x11bbc8[_0x2246('0x210', '0J6f')](_0x11bbc8[_0x2246('0x211', 'gc3h')](_0x17eed7, 0x6), 0x0))] |= _0x18c49c[_0x11bbc8[_0x2246('0x212', '%$pm')](0x1c, _0x11bbc8[_0x2246('0x213', '0J6f')](_0x11bbc8['BOPPX'](_0x11bbc8[_0x2246('0x214', '4mX2')](_0x3471c3[_0x11bbc8['DYWIq'](_0x17eed7, 0x18)], 0x1), _0x5ed64d), 0x1c))] << 0x1f - _0x11bbc8['rqPQA'](_0x17eed7, 0x6);
                    _0x42a9aa[0x0] = _0x11bbc8[_0x2246('0x215', 'E&PI')](_0x11bbc8['DSojH'](_0x42a9aa[0x0], 0x1), _0x42a9aa[0x0] >>> 0x1f);
                    for (_0x17eed7 = 0x1; _0x11bbc8['gydqE'](0x7, _0x17eed7); _0x17eed7++)
                        _0x42a9aa[_0x17eed7] >>>= _0x11bbc8['wdHci'](0x4 * (_0x17eed7 - 0x1), 0x3);
                    _0x42a9aa[0x7] = _0x11bbc8['kJcPI'](_0x11bbc8['pebuH'](_0x42a9aa[0x7], 0x5), _0x11bbc8[_0x2246('0x216', 'nArV')](_0x42a9aa[0x7], 0x1b));
                }
            }
            _0x18c49c = this[_0x2246('0x217', '0I#o')] = [];
            for (_0xe14056 = 0x0; _0x11bbc8['GhdBB'](0x10, _0xe14056); _0xe14056++)
                _0x18c49c[_0xe14056] = _0x24a17c[_0x11bbc8[_0x2246('0x218', '@1Ws')](0xf, _0xe14056)];
        },
        'encryptBlock': function(_0x9c4e98, _0x22cbf3) {
            this[_0x2246('0x219', '&59Q')](_0x9c4e98, _0x22cbf3, this['_subKeys']);
        },
        'decryptBlock': function(_0x5bb9bc, _0x300b25) {
            this['_doCryptBlock'](_0x5bb9bc, _0x300b25, this[_0x2246('0x21a', 'JdVK')]);
        },
        '_doCryptBlock': function(_0x1b2838, _0x119e0a, _0x3ec085) {
            this['_lBlock'] = _0x1b2838[_0x119e0a];
            this[_0x2246('0x1eb', 'nArV')] = _0x1b2838[_0x11bbc8[_0x2246('0x21b', 'Who^')](_0x119e0a, 0x1)];
            _0xf94091[_0x2246('0x21c', 'cs*4')](this, 0x4, 0xf0f0f0f);
            _0xf94091[_0x2246('0x21d', '3j7z')](this, 0x10, 0xffff);
            _0x2ecaf5[_0x2246('0x21e', '0I#o')](this, 0x2, 0x33333333);
            _0x2ecaf5[_0x2246('0x21f', 'MVsm')](this, 0x8, 0xff00ff);
            _0xf94091['call'](this, 0x1, 0x55555555);
            for (var _0x354fa9 = 0x0; 0x10 > _0x354fa9; _0x354fa9++) {
                if (_0x11bbc8['TFZnG'](_0x11bbc8[_0x2246('0x220', 'E&PI')], _0x11bbc8[_0x2246('0x221', 'sy^o')])) {
                    for (var _0x3601ac = _0x3ec085[_0x354fa9], _0x460382 = this[_0x2246('0x222', '4VZ$')], _0x323472 = this[_0x2246('0x223', 'Jsmq')], _0x47a2d3 = 0x0, _0x4e3880 = 0x0; _0x11bbc8['kyIdP'](0x8, _0x4e3880); _0x4e3880++)
                        _0x47a2d3 |= _0x4277d7[_0x4e3880][_0x11bbc8['CiiQa'](_0x11bbc8[_0x2246('0x224', 'RQ2o')](_0x323472, _0x3601ac[_0x4e3880]) & _0x59d0f4[_0x4e3880], 0x0)];
                    this[_0x2246('0x225', '0I#o')] = _0x323472;
                    this['_rBlock'] = _0x11bbc8['kyDGA'](_0x460382, _0x47a2d3);
                } else {
                    _0x119e0a[_0x2246('0x226', 'hGD!')] -= _0x11bbc8[_0x2246('0x227', 'Jsmq')](_0x119e0a[_0x2246('0x228', 'GL3Q')][_0x11bbc8[_0x2246('0x229', '&59Q')](_0x11bbc8[_0x2246('0x22a', 'lav3')](_0x119e0a[_0x2246('0x19e', 'gc3h')], 0x1), 0x2)], 0xff);
                }
            }
            _0x3ec085 = this[_0x2246('0x22b', 'hGD!')];
            this[_0x2246('0x22c', 'fniG')] = this['_rBlock'];
            this[_0x2246('0x22d', 'R*c1')] = _0x3ec085;
            _0xf94091[_0x2246('0x22e', 'UwHa')](this, 0x1, 0x55555555);
            _0x2ecaf5[_0x2246('0x22f', 'nArV')](this, 0x8, 0xff00ff);
            _0x2ecaf5[_0x2246('0x5d', 'E&5L')](this, 0x2, 0x33333333);
            _0xf94091[_0x2246('0x21f', 'MVsm')](this, 0x10, 0xffff);
            _0xf94091[_0x2246('0x230', 'wMtP')](this, 0x4, 0xf0f0f0f);
            _0x1b2838[_0x119e0a] = this['_lBlock'];
            _0x1b2838[_0x11bbc8[_0x2246('0x231', 'fVzz')](_0x119e0a, 0x1)] = this[_0x2246('0x232', 'fDXQ')];
        },
        'keySize': 0x2,
        'ivSize': 0x2,
        'blockSize': 0x2
    });
    _0x3f8d43[_0x2246('0x27', '4mX2')] = _0x57ed25[_0x2246('0x233', 'fDXQ')](_0x4d24f9);
    _0xa844 = _0xa844['TripleDES'] = _0x57ed25['extend']({
        '_doReset': function() {
            var _0x5e5354 = {
                'YhmTO': function _0x5d84bb(_0x51ddef, _0x435823) {
                    return _0x51ddef === _0x435823;
                },
                'EAAtx': _0x2246('0x234', '0I#o'),
                'TngRK': function _0x481275(_0x1d7446, _0x25a26b) {
                    return _0x1d7446(_0x25a26b);
                }
            };
            if (_0x5e5354[_0x2246('0x235', 's&Ar')](_0x5e5354[_0x2246('0x236', ']2BX')], _0x5e5354[_0x2246('0x237', 'R*c1')])) {
                var _0xaee42e = this['_key'][_0x2246('0x238', '7IfV')];
                this['_des1'] = _0x4d24f9[_0x2246('0x239', 'OMJW')](_0x5a476c[_0x2246('0x23a', 'fniG')](_0xaee42e[_0x2246('0x23b', 'E[6X')](0x0, 0x2)));
                this[_0x2246('0x23c', 'OMJW')] = _0x4d24f9[_0x2246('0x23d', '[wS8')](_0x5a476c[_0x2246('0x23e', 'JdVK')](_0xaee42e[_0x2246('0x23f', 'N55v')](0x2, 0x4)));
                this[_0x2246('0x240', '&59Q')] = _0x4d24f9[_0x2246('0x241', '&59Q')](_0x5a476c['create'](_0xaee42e[_0x2246('0x242', '0J6f')](0x4, 0x6)));
            } else {
                _0x5e5354[_0x2246('0x243', '0I#o')](alert, _0x2246('0x244', 'E[6X'));
            }
        },
        'encryptBlock': function(_0x4b1f5c, _0x4056fe) {
            var _0x2b03e6 = {
                'qqSmD': 'rhr'
            };
            if (_0x2b03e6[_0x2246('0x245', 'rk]M')] !== 'adN') {
                this['_des1']['encryptBlock'](_0x4b1f5c, _0x4056fe);
                this[_0x2246('0x246', 'E&5L')][_0x2246('0x247', 'Z2VK')](_0x4b1f5c, _0x4056fe);
                this['_des3'][_0x2246('0x248', '4VZ$')](_0x4b1f5c, _0x4056fe);
            } else {
                this['_des3'][_0x2246('0x249', 'gc3h')](_0x4b1f5c, _0x4056fe);
                this[_0x2246('0x24a', 'RQ2o')][_0x2246('0x1e4', 'RQ2o')](_0x4b1f5c, _0x4056fe);
                this[_0x2246('0x24b', ')q#9')][_0x2246('0x24c', 'fVzz')](_0x4b1f5c, _0x4056fe);
            }
        },
        'decryptBlock': function(_0xd668e6, _0x1268ce) {
            this[_0x2246('0x24d', 'N55v')][_0x2246('0x24e', 'ORle')](_0xd668e6, _0x1268ce);
            this[_0x2246('0x24f', 'ORle')][_0x2246('0x250', 'yY#5')](_0xd668e6, _0x1268ce);
            this[_0x2246('0x251', 'DK[&')][_0x2246('0x252', 'GL3Q')](_0xd668e6, _0x1268ce);
        },
        'keySize': 0x6,
        'ivSize': 0x2,
        'blockSize': 0x2
    });
    _0x3f8d43['TripleDES'] = _0x57ed25[_0x2246('0x253', 'RQ2o')](_0xa844);
}());
var webDES = function() {
    var _0x4da59e = {
        'bUIIa': function _0x2a2af9(_0x779387, _0x4a4fec) {
            return _0x779387 + _0x4a4fec;
        }
    };
    var _0x9843d3 = function(_0x29d556, _0xcc6df, _0x3d7020) {
        if (0x0 == _0xcc6df)
            return _0x29d556[_0x2246('0x254', '4VZ$')](_0x3d7020);
        var _0x48914b;
        _0x48914b = '' + _0x29d556[_0x2246('0x255', 'GL3Q')](0x0, _0xcc6df);
        return _0x48914b += _0x29d556['substr'](_0x4da59e[_0x2246('0x256', 'DK[&')](_0xcc6df, _0x3d7020));
    };
    this[_0x2246('0x257', 'nArV')] = function(_0xa0c834) {
        var _0x51eedc = {
            'pKENi': function _0x2f627(_0x5b6f5a, _0x440924) {
                return _0x5b6f5a === _0x440924;
            },
            'wnfPa': 'ZGz',
            'VMmle': '7|1|8|9|5|2|3|6|0|4',
            'GKWFf': function _0x1a4e13(_0x40cfde, _0x16f3c2) {
                return _0x40cfde == _0x16f3c2;
            },
            'MUPgQ': function _0x342f0d(_0x19038b, _0x4004d6) {
                return _0x19038b >= _0x4004d6;
            },
            'hLXma': function _0x55adaf(_0x45a871, _0x161bdf) {
                return _0x45a871 + _0x161bdf;
            },
            'JdOlO': function _0x13e00a(_0x5899a9, _0x4bb34d) {
                return _0x5899a9 + _0x4bb34d;
            },
            'qrTpg': function _0x1198fb(_0x55b317, _0x22e1db, _0x1b091a) {
                return _0x55b317(_0x22e1db, _0x1b091a);
            },
            'pdmMk': function _0xe2b022(_0x4af286, _0x4c2fd4) {
                return _0x4af286 - _0x4c2fd4;
            },
            'xVKWW': function _0x1094a3(_0x5f3627, _0x2a0ac5, _0x3ad2e5) {
                return _0x5f3627(_0x2a0ac5, _0x3ad2e5);
            }
        };
        if (_0x51eedc[_0x2246('0x258', '@1Ws')](_0x2246('0x259', 'E&PI'), _0x51eedc['wnfPa'])) {
            this['_append'](a);
            return this[_0x2246('0x25a', 'GL3Q')]();
        } else {
            var _0x492a62 = _0x51eedc[_0x2246('0x25b', '&59Q')][_0x2246('0x25c', ')q#9')]('|')
              , _0x356b01 = 0x0;
            while (!![]) {
                switch (_0x492a62[_0x356b01++]) {
                case '0':
                    _0x554c90 = _grsa_JS[_0x2246('0x25d', 'E&PI')]['decrypt']({
                        'ciphertext': _grsa_JS['enc'][_0x2246('0x25e', 'sy^o')]['parse'](_0xa0c834)
                    }, _0x2cf8ae, {
                        'iv': _0x554c90,
                        'mode': _grsa_JS[_0x2246('0x16c', 'O^50')][_0x2246('0x25f', 'Who^')],
                        'padding': _grsa_JS[_0x2246('0x260', '7IfV')][_0x2246('0x261', 'E&PI')]
                    })[_0x2246('0x1c', 'yY#5')](_grsa_JS['enc'][_0x2246('0x262', ']2BX')]);
                    continue;
                case '1':
                    if (_0x51eedc[_0x2246('0x263', 'Jsmq')](null, _0xa0c834) || _0x51eedc[_0x2246('0x264', '!2eC')](0x10, _0xa0c834['length']))
                        return _0xa0c834;
                    continue;
                case '2':
                    _0xa0c834 = _0x9843d3(_0xa0c834, _0x2cf8ae, 0x8);
                    continue;
                case '3':
                    _0x2cf8ae = _grsa_JS[_0x2246('0x265', 'RQ2o')][_0x2246('0x266', '3j7z')][_0x2246('0x267', 'RQ2o')](_0x554c90);
                    continue;
                case '4':
                    return _0x554c90[_0x2246('0x268', 'cs*4')](0x0, _0x51eedc[_0x2246('0x269', 'MVsm')](_0x554c90[_0x2246('0x26a', '0J6f')]('}'), 0x1));
                case '5':
                    _0x554c90 = _0xa0c834[_0x2246('0x26b', 'UwHa')](_0x2cf8ae, 0x8);
                    continue;
                case '6':
                    _0x554c90 = _grsa_JS[_0x2246('0x26c', '4VZ$')]['Utf8']['parse'](_0x554c90);
                    continue;
                case '7':
                    if (false || false)
                        return '';
                    continue;
                case '8':
                    var _0x554c90 = _0x51eedc[_0x2246('0x26e', 'Yb4P')](_0x51eedc[_0x2246('0x26f', 'BQ5p')](parseInt, _0xa0c834[_0x51eedc[_0x2246('0x270', 'Z2VK')](_0xa0c834['length'], 0x1)], 0x10), 0x9)
                      , _0x2cf8ae = _0x51eedc[_0x2246('0x271', 'yY#5')](parseInt, _0xa0c834[_0x554c90], 0x10);
                    continue;
                case '9':
                    _0xa0c834 = _0x9843d3(_0xa0c834, _0x554c90, 0x1);
                    continue;
                }
                break;
            }
        }
    }
    ;
}
  , webInstace = new webDES();

var e = "A72251707A958AB77A90B3E2F2DE0F13392F38A1AB9C5151A1DB9D2B9832C5F439E38EB493AE32EE499748962FA895DB00350AF66777BFD74E927C760B510E06B07BBE8CB0F0C73159A4819CDD1E9B9356A0430BDDC46B5F0F0FA76742FB5EEE7F229B8A9D161CB69E704AC8E3843179C26A5F09E2006924E1F97B49756E15C19BDC3E4799291199593CECD3DF402E88964E04EB33AE32EE499748962FA895DB00350AF663296F9C2E64F4DA28FB368BAAEF575BE32C95EFAE05A03AEAB14DD2DCF9253005CF753194535F70B2FB5EEE7F229B8A90707CA79C7FACA9B3843179C26A5F09E86EF1A47C619F59C56E15C19BDC3E479F331A8545C49CDB2F402E88964E04EB33AE32EE499748962FA895DB00350AF66EA19FB3B1FE9A26C6DCB61295B8A2D4732C95EFAE05A03AE34BC69B672ADFBC31177F21D22FA028726E370911847C247A168332CDAECAC333843179C26A5F09E8A9244C0C960130EEB9ABA7372D64601772C9FE14D8461EAF402E88964E04EB33AE32EE499748962FA895DB00350AF66504B89E15242888D514B9BCB6FA5BC6E32C95EFAE05A03AE8865CF12F4758D34D1B4ABF5EB6BBE5A26E370911847C247B17A867A144C78093843179C26A5F09E9A2273B9BF68A86BEB9ABA7372D646011EE941AC395632A4F402E88964E04EB33AE32EE499748962FA895DB00350AF66F2E55FD0E783E44A8FC61603885433B232C95EFAE05A03AE72717B5767F335D42141F13539CF132D26E370911847C2471ED362DE775621F73843179C26A5F09E108442583A5F99A9EB9ABA7372D64601952CB8CD2E48404FF402E88964E04EB33AE32EE499748962FA895DB00350AF660E310B37A231FDB7A4900AEA6CF45FC132C95EFAE05A03AEC6406EA2AC7DB887D6471BAC7A939C3E26E370911847C247F3D005CEE4A4499A3843179C26A5F09E043D9570F711122EEB9ABA7372D64601DDE53FA4635C9184F402E88964E04EB33AE32EE499748962FA895DB00350AF66257613A71816D64CACE1423D52FCF23315AED1A0710057C2229A125C322288B10D13B140B3DCC4BA26E370911847C247C7F99614F87130913843179C26A5F09EBEAFDED4C1ED5555EB9ABA7372D646018ABD576B266E504EF402E88964E04EB33AE32EE499748962FA895DB00350AF66117BA2E5A6D8FCF844232133D069450415AED1A0710057C21258CAD93E6A55651D2D77F13A91D16D938C52073D89934A335FCA5C1967ED333843179C26A5F09E1C5C637C07B2C519EB9ABA7372D64601199DE0182BB1D1C1F402E88964E04EB33AE32EE499748962FA895DB00350AF6662EEC266DDE78F5CDF04EC4401CAFA5E15AED1A0710057C2CD07A14D055B4D7A7471F59F254AAA14938C52073D89934A6E5988E30E2164C63843179C26A5F09E8A8F20CA91F74051EB9ABA7372D646010BC43F5E25DD6EA1F402E88964E04EB33AE32EE499748962FA895DB00350AF66F4D33F084BE242BFB4FC8ABFD189349B15AED1A0710057C213012F63A2E1291B2E240C3B17694079938C52073D89934A0400D6F047D380BF3843179C26A5F09E07499331A595571CEB9ABA7372D64601FDACF4CD6AD54885845A88CDA87F8889600A329082322B72ECE30DF6CFEC7440B2C96F8AEA649C64"
console.log(webInstace.shell(e));
```

- python代码

```python
import subprocess
from functools import partial
subprocess.Popen = partial(subprocess.Popen, encoding="utf-8")

import requests
import execjs

headers = {
    "Accept": "text/plain, */*; q=0.01",
    "Accept-Language": "zh-CN,zh;q=0.9",
    "Cache-Control": "no-cache",
    "Connection": "keep-alive",
    "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
    "Origin": "https://www.endata.com.cn",
    "Pragma": "no-cache",
    "Sec-Fetch-Dest": "empty",
    "Sec-Fetch-Mode": "cors",
    "Sec-Fetch-Site": "same-origin",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36",
    "X-Requested-With": "XMLHttpRequest",
    "sec-ch-ua": "^\\^Chromium^^;v=^\\^118^^, ^\\^Google",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "^\\^Windows^^"
}
url = "https://www.endata.com.cn/API/GetData.ashx"
data = {
    "sdate1": "2023-10-13",
    "edate1": "2023-10-15",
    "sdate2": "2023-10-06",
    "edate2": "2023-10-08",
    "MethodName": "BoxOffice_GetWeekendInfoData"
}
response = requests.post(url, headers=headers, data=data)
with open('1111.js', 'r')as f:
    js_code = f.read()

js = execjs.compile(js_code)
result = js.call('webInstace.shell', response.text)
print(result)
```





### 三. AES算法

**环境安装**

```python
pip install pycryptodome -i pip源
```

#### 1. 算法简介

		简介：全称高级加密标准（英文名称：Advanced Encryption Standard），在密码学中又称 Rijndael 加密法，由美国国家标准与技术研究院 （NIST）于 2001 年发布，并在 2002 年成为有效的标准，是美国联邦政府采用的一种区块加密标准。这个标准用来替代原先的 DES，已经被多方分析且广为全世界所使用，它本身只有一个密钥，即用来实现加密，也用于解密。

- mode 支持：CBC，CFB，CTR，CTRGladman，ECB，OFB 等。
- padding 支持：ZeroPadding，NoPadding，AnsiX923，Iso10126，Iso97971，Pkcs7 等。

**参考资料：**

- RFC 3268：https://datatracker.ietf.org/doc/rfc3268/
- AES 维基百科：https://en.wikipedia.org/wiki/Advanced_Encryption_Standard



**参数定义：**

1. key length（密钥位数，密码长度）`AES128，AES192，AES256（128 位、192 位或 256 位）`
2. key （密钥，密码）key指的就是密码了，`AES128`就是`128位`的，如果位数不够，某些库可能会自动填充到`128`。
3. IV （向量）IV称为初始向量，不同的IV加密后的字符串是不同的，加密和解密需要相同的IV。
4. mode （加密模式）AES分为几种模式，比如ECB，CBC，CFB等等，这些模式除了ECB由于没有使用IV而不太安全，其他模式差别并没有太明显。
5. padding （填充方式）对于加密解密两端需要使用同一的PADDING模式，大部分PADDING模式为`PKCS5, PKCS7, NOPADDING`。

**加密原理：**

		AES加密算法采用分组密码体制，每个分组数据的长度为`128位16个字节`，密钥长度可以是`128位16个字节`、`192位或256位`，一共有四种加密模式，我们通常采用需要初始向量IV的CBC模式，初始向量的长度也是`128位16个字节`。

#### 2.  JavaScript 实现

类似网站：https://www.dns.com/login.html

```javascript
// 引用 crypto-js 加密模块
var CryptoJS = require('crypto-js')

function tripleAesEncrypt() {
    var key = CryptoJS.enc.Utf8.parse(aesKey),
        iv = CryptoJS.enc.Utf8.parse(aesIv),
        srcs = CryptoJS.enc.Utf8.parse(text),
        // CBC 加密方式，Pkcs7 填充方式
        encrypted = CryptoJS.AES.encrypt(srcs, key, {
            iv: iv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        });
    return encrypted.toString();
}

function tripleAesDecrypt() {
    var key = CryptoJS.enc.Utf8.parse(aesKey),
        iv = CryptoJS.enc.Utf8.parse(aesIv),
        srcs = encryptedData,
        // CBC 加密方式，Pkcs7 填充方式
        decrypted = CryptoJS.AES.decrypt(srcs, key, {
            iv: iv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        });
    return decrypted.toString(CryptoJS.enc.Utf8);
}

var text = "I love Python!"       // 待加密对象
var aesKey = "6f726c64f2c2057c"   // 密钥，16 倍数
var aesIv = "0123456789ABCDEF"    // 偏移量，16 倍数

var encryptedData = tripleAesEncrypt()
var decryptedData = tripleAesDecrypt()

console.log("加密字符串: ", encryptedData)
console.log("解密字符串: ", decryptedData)

// 加密字符串:  dZL7TLJR786VGvuUvqYGoQ==
// 解密字符串:  I love Python!
```



#### 3. 实际案例1

##### 1. 逆向目标

- 目标：建筑市场数据采集

- 主页：https://jzsc.mohurd.gov.cn/data/company

- 接口：https://jzsc.mohurd.gov.cn/api/webApi/dataservice/query/comp/list

- 逆向参数：`data加密`

##### 2. 逆向分析



###### 1.加密数据定位

- 关键字`decrpyt`定位

![](./images/016.png)

- xhr断点(同样的可以找到发送ajax的回调位置,不好找的话可以直接在执行一下步,因为他一定会进入到回调的位置进行解密)

![](./images/017.png)

###### 2. 加密代码分析

- 通过m函数进行解密操作

![](./images/018.png)

- 解密方法为AES

![](./images/019.png)



###### 3. 逆向结果

- JavaScript代码

```javascript
var cryptojs = require('crypto-js')

function m(t) {
    f = cryptojs.enc.Utf8.parse("jo8j9wGw%6HbxfFn");
    h = cryptojs.enc.Utf8.parse("0123456789ABCDEF");
    var e = cryptojs.enc.Hex.parse(t)
        , n = cryptojs.enc.Base64.stringify(e)
        , a = cryptojs.AES.decrypt(n, f, {
        iv: h,
        mode: cryptojs.mode.CBC,
        padding: cryptojs.pad.Pkcs7
    })
        , r = a.toString(cryptojs.enc.Utf8);
    return r.toString()
}
```

- python代码

```python
import requests
import execjs

headers = {
    "Referer": "https://jzsc.mohurd.gov.cn/data/company",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36",
    "timeout": "30000"
}

url = "https://jzsc.mohurd.gov.cn/APi/webApi/dataservice/query/comp/list"
params = {
    "pg": "1",
    "pgsz": "15",
    "total": "450"
}
response = requests.get(url, headers=headers, params=params)

with open('建筑市场.js', 'r', encoding='utf-8')as f:
    js_code = f.read()

js = execjs.compile(js_code)
result = js.call('m', response.text)
print(result)

```



#### 4.实际案例2

##### 1. 逆向目标

地址：https://www.kanzhun.com/

需求：表单 + 数据结果



##### 2. 表单逆向分析

###### 1.加密数据定位

- 关键字定位`encrypt`(搜索比较多需要多下断点)

![](./images/020.png)

- xhr断点定位(通过xhr断点离的位置可能比较远,我们需要跟栈分析)

![](./images/021.png)

###### 2.加密代码分析

- b和kiv的值都是一样的 b是t赋值   kiv是a赋值
- t = (0,M.mA)(n, {iv: a}).replace(/\//g, "_").replace(/\+/g, "-").replace(/=/g, "~")));   调用的M.mA函数
- a = (0,M._A)()  调用的M._A函数

![](./images/022.png)

###### 3.逆向结果

- JavaScript代码

```JavaScript
var cryptojs = require('crypto-js')


function u() {
    var e, t, n, r, i = null;
    t = new RegExp("\\u200c", "g"),
        n = new RegExp("\\u200d", "g"),
        r = new RegExp(".{8}", "g"),
        e = "‍‌‍‍‍‌‌‌‍‍‌‍‍‌‍‍‍‍‌‍‍‌‍‍‍‌‍‌‍‍‍‌‍‌‌‍‍‍‍‌‍‌‌‌‍‌‌‌‍‌‌‍‍‍‌‌‍‌‌‍‌‍‌‌‍‌‍‍‍‌‌‌‍‌‌‍‍‌‌‍‍‌‌‍‍‍‍‌‍‌‍‍‌‌‍‍‍‌‍‍‍‍‌‍‍‍‌‌‌‍‍‌‍‍‌‌‍‌‌‌‍‌‌‌‍‍‌‍".replace(r, (function (e) {
                return String.fromCharCode(parseInt(e.replace(t, 1).replace(n, 0), 2))
            }
        )),
        i = {
            key: cryptojs.enc.Utf8.parse(e),
            mode: cryptojs.mode.CBC,
            pad: cryptojs.pad.Pkcs7
        };
    return i


}

p = function (e) {
    void 0 === e && (e = 16);
    for (var t = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""), n = "", r = 0; r < e; r++) {
        n += t[Math.ceil(61 * Math.random())]
    }
    return n
}

l = function (e) {
    t = p();
    var n = u()
        , r = cryptojs.AES.encrypt(e.toString(), n.key, {
        iv: cryptojs.enc.Utf8.parse(t),
        mode: n.mode,
        padding: n.pad
    });
    return {
        b: r.toString(),
        kiv: t
    }

}

res = l('{"query":"python","cityCode":101020100,"industryCodes":"","pageNum":1,"limit":15}')
console.log(res)
```

- python代码

```python
import requests
import execjs


with open('demo.js', 'r', encoding='utf-8')as f:
    js_code = f.read()

data = '{"query":"爬虫","cityCode":101010100,"industryCodes":"","pageNum":1,"limit":15}'

js = execjs.compile(js_code)

par = js.call('l', data)
print(par)
headers = {
    "href": "https://www.kanzhun.com/search?cityCode=101010100&industryCodes=&pageNum=1&query=python&type=1",
    "referer": "https://www.kanzhun.com/search?cityCode=101010100&industryCodes=&pageNum=1&query=python&type=1",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36",
}

url = "https://www.kanzhun.com/api_to/search/company_v2.json"
params = {
    "b": par['b'],
    "kiv": par['kiv']
}
response = requests.get(url, headers=headers, params=params)

print(response.text)
print(response)

```







##### 3.响应解密分析

###### 1.解密代码定位

- 关键字`decrypt`定位

- 可以下Hook断点调试(通过hook定位响应解密位置的时候需要往上找,因为只有解密之后变成json数据了,才能进行JSON.parse转换成数组数据)

```javascript
var my_parse = JSON.parse;
JSON.parse = function (params) {
    //这里可以添加其他逻辑比如
    debugger
    console.log("json_parse params:",params);
    return my_parse(params);
};
```

![](./images/023.png)

###### 2.解密代码分析

- 可以看出数据是在(0,M.gy)(e.data, {iv: "string" == typeof n ? JSON.parse(n).kiv : n.kiv })进行解密的

- 跟进函数看解密的方法,可以明显看出来是AES的解密
- 解密的key就是用的请求参数加密时候的key
- 标准的算法我们没有必要去扣直接用标准库就行

![](./images/024.png)

###### 3.逆向结果

- JavaScript代码

```javascript
c = function (e, t) {
    var n = u()
        , r = cryptojs.AES.decrypt(e.toString(), n.key, {
        iv: cryptojs.enc.Utf8.parse(t),
        mode: n.mode,
        padding: n.pad
    });
    return r = r.toString(cryptojs.enc.Utf8)
};

```

- python代码

```python
import requests
import execjs


with open('demo.js', 'r', encoding='utf-8')as f:
    js_code = f.read()

data = '{"query":"爬虫","cityCode":101010100,"industryCodes":"","pageNum":1,"limit":15}'

js = execjs.compile(js_code)

par = js.call('l', data)
print(par)
headers = {
    "href": "https://www.kanzhun.com/search?cityCode=101010100&industryCodes=&pageNum=1&query=python&type=1",
    "referer": "https://www.kanzhun.com/search?cityCode=101010100&industryCodes=&pageNum=1&query=python&type=1",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36",
}

url = "https://www.kanzhun.com/api_to/search/company_v2.json"
params = {
    "b": par['b'],
    "kiv": par['kiv']
}
response = requests.get(url, headers=headers, params=params)

res = js.call('c', response.text, par['kiv'])
print(res)

```



### 四.魔改算法

`魔改算法`通常指的是对现有算法进行修改或改进，以满足特定需求、优化性能或解决特定问题的过程

##### 1. 逆向目标

地址：https://www.aigei.com/sound/class/role?page=7#resContainer

接口:https://www.aigei.com/gei-common/jsonComp/f/awd/log.json?t=5657288%2C30409027%2C29958178%2C5633685%2C5657573%2C5635533%2C30392468%2C5657696%2C5656237%2C5656067%2C30377190%2C5634248%2C41239479%2C2286941%2C29951406%2C69050439%2C5636242%2C2286905%2C5632707%2C68820738&w=rowPc&f=false

需求：解密数据(不做数据要求只需解密)

##### 2. 逆向分析

###### 1.加密数据定位

- xhr断点定位(需要对响应数据解密,找到ajax的回调方法)

![](./images/025.png)

- 关键字`decrypt(`定位(需要碰运气的成分)

![](./images/026.png)

###### 2.加密代码分析

- 跟ajax断点定位到匿名函数
- 分析函数可以得出先将响应的b数据进行分割,这个判断条件是没有成立的可以不用管,直接扣for循环的代码
- 循环中c的赋值对我们用处也不大,我们可以不用扣下来
- 主要代码就是u = (new llii1i1iill).ilil111lii(u)  这个方法会将我们分割之后的数据在进行转换  
- u = ili11liii(u, "il1looOo")会将转换之后的密文进行解密  这两个方法都是要扣的

![](./images/027.png)

- ili11liii方法里可以看到是网站自己封装的一个魔改算法,所以我们需要把GeiJS算法给扣下来,这样的算法最好是我们可以拷贝他整个代码进行格式化,会更加方便些

![](./images/028.png)



###### 3.逆向结果

- JavaScript代码

```JavaScript
var GeiJS = GeiJS || function (a, b) {
    var c = {}
        , e = c.lib = {}
        , g = function () {
    }
        , k = e.Base = {
        extend: function (f) {
            g.prototype = this;
            var l = new g;
            f && l.mixIn(f);
            l.hasOwnProperty("init") || (l.init = function () {
                    l.$super.init.apply(this, arguments)
                }
            );
            l.init.prototype = l;
            l.$super = this;
            return l
        },
        create: function () {
            var f = this.extend();
            f.init.apply(f, arguments);
            return f
        },
        init: function () {
        },
        mixIn: function (f) {
            for (var l in f)
                f.hasOwnProperty(l) && (this[l] = f[l]);
            f.hasOwnProperty("toString") && (this.toString = f.toString)
        },
        clone: function () {
            return this.init.prototype.extend(this)
        }
    }
        , q = e.WordArray = k.extend({
        init: function (f, l) {
            f = this.words = f || [];
            this.sigBytes = l != b ? l : 4 * f.length
        },
        toString: function (f) {
            return (f || t).stringify(this)
        },
        concat: function (f) {
            var l = this.words
                , d = f.words
                , n = this.sigBytes;
            f = f.sigBytes;
            this.clamp();
            if (n % 4)
                for (var w = 0; w < f; w++)
                    l[n + w >>> 2] |= (d[w >>> 2] >>> 24 - w % 4 * 8 & 255) << 24 - (n + w) % 4 * 8;
            else if (65535 < d.length)
                for (w = 0; w < f; w += 4)
                    l[n + w >>> 2] = d[w >>> 2];
            else
                l.push.apply(l, d);
            this.sigBytes += f;
            return this
        },
        clamp: function () {
            var f = this.words
                , l = this.sigBytes;
            f[l >>> 2] &= 4294967295 << 32 - l % 4 * 8;
            f.length = a.ceil(l / 4)
        },
        clone: function () {
            var f = k.clone.call(this);
            f.words = this.words.slice(0);
            return f
        },
        random: function (f) {
            for (var l = [], d = 0; d < f; d += 4)
                l.push(4294967296 * a.random() | 0);
            return new q.init(l, f)
        }
    })
        , v = c.enc = {}
        , t = v.Hex = {
        stringify: function (f) {
            var l = f.words;
            f = f.sigBytes;
            for (var d = [], n = 0; n < f; n++) {
                var w = l[n >>> 2] >>> 24 - n % 4 * 8 & 255;
                d.push((w >>> 4).toString(16));
                d.push((w & 15).toString(16))
            }
            return d.join("")
        },
        parse: function (f) {
            for (var l = f.length, d = [], n = 0; n < l; n += 2)
                d[n >>> 3] |= parseInt(f.substr(n, 2), 16) << 24 - n % 8 * 4;
            return new q.init(d, l / 2)
        }
    }
        , r = v.Latin1 = {
        stringify: function (f) {
            var l = f.words;
            f = f.sigBytes;
            for (var d = [], n = 0; n < f; n++)
                d.push(String.fromCharCode(l[n >>> 2] >>> 24 - n % 4 * 8 & 255));
            return d.join("")
        },
        parse: function (f) {
            for (var l = f.length, d = [], n = 0; n < l; n++)
                d[n >>> 2] |= (f.charCodeAt(n) & 255) << 24 - n % 4 * 8;
            return new q.init(d, l)
        }
    }
        , m = v.Utf8 = {
        stringify: function (f) {
            try {
                return decodeURIComponent(escape(r.stringify(f)))
            } catch (l) {
                throw Error("Malformed UTF-8 data");
            }
        },
        parse: function (f) {
            return r.parse(unescape(encodeURIComponent(f)))
        }
    }
        , u = e.BufferedBlockAlgorithm = k.extend({
        reset: function () {
            this._data = new q.init;
            this._nDataBytes = 0
        },
        _append: function (f) {
            "string" == typeof f && (f = m.parse(f));
            this._data.concat(f);
            this._nDataBytes += f.sigBytes
        },
        _process: function (f) {
            var l = this._data
                , d = l.words
                , n = l.sigBytes
                , w = this.blockSize
                , y = n / (4 * w);
            y = f ? a.ceil(y) : a.max((y | 0) - this._minBufferSize, 0);
            f = y * w;
            n = a.min(4 * f, n);
            if (f) {
                for (var z = 0; z < f; z += w)
                    this._doProcessBlock(d, z);
                z = d.splice(0, f);
                l.sigBytes -= n
            }
            return new q.init(z, n)
        },
        clone: function () {
            var f = k.clone.call(this);
            f._data = this._data.clone();
            return f
        },
        _minBufferSize: 0
    });
    e.Hasher = u.extend({
        cfg: k.extend(),
        init: function (f) {
            this.cfg = this.cfg.extend(f);
            this.reset()
        },
        reset: function () {
            u.reset.call(this);
            this._doReset()
        },
        update: function (f) {
            this._append(f);
            this._process();
            return this
        },
        finalize: function (f) {
            f && this._append(f);
            return this._doFinalize()
        },
        blockSize: 16,
        _createHelper: function (f) {
            return function (l, d) {
                return (new f.init(d)).finalize(l)
            }
        },
        _createHmacHelper: function (f) {
            return function (l, d) {
                return (new h.HMAC.init(f, d)).finalize(l)
            }
        }
    });
    var h = c.algo = {};
    return c
}(Math);

function ili11liii(a, b) {
    b = GeiJS.enc.Utf8.parse(b);
    return GeiJS.OBJFJKET.decrypt({
        ciphertext: GeiJS.enc.Base64.parse(a)
    }, b, {
        mode: GeiJS.mode.FENCTIOP,
        padding: GeiJS.pad.GFACDE
    }).toString(GeiJS.enc.Utf8)
}

ilil111lii = function (a) {
    _keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
    var b = ""
        , c = 0;
    for (a = a.replace(/[^A-Za-z0-9\+\/=]/g, ""); c < a.length;) {
        var e = _keyStr.indexOf(a.charAt(c++));
        var g = _keyStr.indexOf(a.charAt(c++));
        var k = _keyStr.indexOf(a.charAt(c++));
        var q = _keyStr.indexOf(a.charAt(c++));
        e = e << 2 | g >> 4;
        g = (g & 15) << 4 | k >> 2;
        var v = (k & 3) << 6 | q;
        b += String.fromCharCode(e);
        64 != k && (b += String.fromCharCode(g));
        64 != q && (b += String.fromCharCode(v))
    }
    return b = _utf8_decode(b)
}

function aa(r) {
    var c = '';
    var E = r.b.split("|");
    for (G = 0; G < E.length; G++) {
        u = E[G];
        u = ilil111lii(u),
            u = ili11liii(u, "il1looOo"),
            u = u.split(",")
        c += u;

    }
    return c
}

var r = {
    "p": 200,
    "b": ""}
    aa(r)
```

- python代码

```python
import requests
import execjs

headers = {
    "referer": "https://www.aigei.com/sound/class/role?page=11",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36",
}
url = "https://www.aigei.com/gei-common/jsonComp/f/awd/log.json"
params = {
    "t": '5757651,5634335,5739749,5634319,31854576,5657618,5655610,5658078,5635730,5636124,5634306,30392499,5635683,30392510,5636099,30392498,31854584,5635575,5634806,5636275',
    "w": "rowPc",
    "f": "false"
}
response = requests.get(url, headers=headers, params=params)
with open('demo.js', 'r', encoding='utf-8')as f:
    js_code = f.read()
js = execjs.compile(js_code)
res = js.call('aa', response.json())
print(res)

```